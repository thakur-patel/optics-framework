<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A powerful, extensible no-code test automation framework designed for vision-powered, data-driven testing and production app synthetic monitoring."><meta name=author content="Dhruv Menon"><link href=https://mozarkai.github.io/optics-framework/architecture/components/ rel=canonical><link href=../ rel=prev><link href=../engines/ rel=next><link rel=icon href=../../assets/mozark_new_logo.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.3"><title>Components - Optics Framework</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#component-architecture class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Optics Framework" class="md-header__button md-logo" aria-label="Optics Framework" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27zM5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39S16.66.269 11 5.93c-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.55.56 1.37.74 2.12.46A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61m-7.07 7.07c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83s-2.05.78-2.83 0m-5.66 7.07-1.41-1.41zM6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22zM2 22h1.41l4.77-4.76-1.42-1.41L2 20.59zm0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Optics Framework </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Components </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/mozarkai/optics-framework title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> mozarkai/optics-framework </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../introduction/ class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=../../quickstart/ class=md-tabs__link> Quick Start </a> </li> <li class=md-tabs__item> <a href=../../configuration/ class=md-tabs__link> Configuration </a> </li> <li class=md-tabs__item> <a href=../../user_workflow/ class=md-tabs__link> User Workflow </a> </li> <li class=md-tabs__item> <a href=../../usage/usage/ class=md-tabs__link> Usage </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Architecture </a> </li> <li class=md-tabs__item> <a href=../../api_reference/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../contribution/contributing_guidelines/ class=md-tabs__link> Contribution </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Optics Framework" class="md-nav__button md-logo" aria-label="Optics Framework" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27zM5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39S16.66.269 11 5.93c-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.55.56 1.37.74 2.12.46A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61m-7.07 7.07c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83s-2.05.78-2.83 0m-5.66 7.07-1.41-1.41zM6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22zM2 22h1.41l4.77-4.76-1.42-1.41L2 20.59zm0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76z"/></svg> </a> Optics Framework </label> <div class=md-nav__source> <a href=https://github.com/mozarkai/optics-framework title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> mozarkai/optics-framework </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../quickstart/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../user_workflow/ class=md-nav__link> <span class=md-ellipsis> User Workflow </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Usage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../usage/usage/ class=md-nav__link> <span class=md-ellipsis> Usage Overview </span> </a> </li> <li class=md-nav__item> <a href=../../usage/CLI_usage/ class=md-nav__link> <span class=md-ellipsis> CLI Usage </span> </a> </li> <li class=md-nav__item> <a href=../../usage/keyword_usage/ class=md-nav__link> <span class=md-ellipsis> Keyword Usage </span> </a> </li> <li class=md-nav__item> <a href=../../usage/library_usage/ class=md-nav__link> <span class=md-ellipsis> Library Usage </span> </a> </li> <li class=md-nav__item> <a href=../../usage/robot_usage/ class=md-nav__link> <span class=md-ellipsis> Robot Framework Usage </span> </a> </li> <li class=md-nav__item> <a href=../../usage/REST_API_usage/ class=md-nav__link> <span class=md-ellipsis> REST API Usage </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Architecture Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Components </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#core-components class=md-nav__link> <span class=md-ellipsis> Core Components </span> </a> <nav class=md-nav aria-label="Core Components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#optics-class class=md-nav__link> <span class=md-ellipsis> Optics Class </span> </a> </li> <li class=md-nav__item> <a href=#sessionmanager class=md-nav__link> <span class=md-ellipsis> SessionManager </span> </a> </li> <li class=md-nav__item> <a href=#opticsbuilder class=md-nav__link> <span class=md-ellipsis> OpticsBuilder </span> </a> </li> <li class=md-nav__item> <a href=#confighandler class=md-nav__link> <span class=md-ellipsis> ConfigHandler </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#factory-system class=md-nav__link> <span class=md-ellipsis> Factory System </span> </a> <nav class=md-nav aria-label="Factory System"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#genericfactory class=md-nav__link> <span class=md-ellipsis> GenericFactory </span> </a> </li> <li class=md-nav__item> <a href=#devicefactory class=md-nav__link> <span class=md-ellipsis> DeviceFactory </span> </a> </li> <li class=md-nav__item> <a href=#elementsourcefactory class=md-nav__link> <span class=md-ellipsis> ElementSourceFactory </span> </a> </li> <li class=md-nav__item> <a href=#imagefactory-and-textfactory class=md-nav__link> <span class=md-ellipsis> ImageFactory and TextFactory </span> </a> </li> <li class=md-nav__item> <a href=#instancefallback_1 class=md-nav__link> <span class=md-ellipsis> InstanceFallback </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#interfaces class=md-nav__link> <span class=md-ellipsis> Interfaces </span> </a> <nav class=md-nav aria-label=Interfaces> <ul class=md-nav__list> <li class=md-nav__item> <a href=#driverinterface class=md-nav__link> <span class=md-ellipsis> DriverInterface </span> </a> </li> <li class=md-nav__item> <a href=#elementsourceinterface class=md-nav__link> <span class=md-ellipsis> ElementSourceInterface </span> </a> </li> <li class=md-nav__item> <a href=#imageinterface class=md-nav__link> <span class=md-ellipsis> ImageInterface </span> </a> </li> <li class=md-nav__item> <a href=#textinterface class=md-nav__link> <span class=md-ellipsis> TextInterface </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#api-modules class=md-nav__link> <span class=md-ellipsis> API Modules </span> </a> <nav class=md-nav aria-label="API Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#actionkeyword class=md-nav__link> <span class=md-ellipsis> ActionKeyword </span> </a> </li> <li class=md-nav__item> <a href=#appmanagement class=md-nav__link> <span class=md-ellipsis> AppManagement </span> </a> </li> <li class=md-nav__item> <a href=#verifier class=md-nav__link> <span class=md-ellipsis> Verifier </span> </a> </li> <li class=md-nav__item> <a href=#flowcontrol class=md-nav__link> <span class=md-ellipsis> FlowControl </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#component-interactions class=md-nav__link> <span class=md-ellipsis> Component Interactions </span> </a> <nav class=md-nav aria-label="Component Interactions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#initialization-flow class=md-nav__link> <span class=md-ellipsis> Initialization Flow </span> </a> </li> <li class=md-nav__item> <a href=#action-execution-flow class=md-nav__link> <span class=md-ellipsis> Action Execution Flow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#extension-points class=md-nav__link> <span class=md-ellipsis> Extension Points </span> </a> <nav class=md-nav aria-label="Extension Points"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adding-a-new-driver class=md-nav__link> <span class=md-ellipsis> Adding a New Driver </span> </a> </li> <li class=md-nav__item> <a href=#adding-a-new-element-source class=md-nav__link> <span class=md-ellipsis> Adding a New Element Source </span> </a> </li> <li class=md-nav__item> <a href=#adding-a-new-vision-model class=md-nav__link> <span class=md-ellipsis> Adding a New Vision Model </span> </a> </li> <li class=md-nav__item> <a href=#adding-a-new-keyword class=md-nav__link> <span class=md-ellipsis> Adding a New Keyword </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#related-documentation class=md-nav__link> <span class=md-ellipsis> Related Documentation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../engines/ class=md-nav__link> <span class=md-ellipsis> Engines </span> </a> </li> <li class=md-nav__item> <a href=../strategies/ class=md-nav__link> <span class=md-ellipsis> Strategies </span> </a> </li> <li class=md-nav__item> <a href=../execution/ class=md-nav__link> <span class=md-ellipsis> Execution </span> </a> </li> <li class=md-nav__item> <a href=../event_system/ class=md-nav__link> <span class=md-ellipsis> Event System </span> </a> </li> <li class=md-nav__item> <a href=../error_handling/ class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> </li> <li class=md-nav__item> <a href=../api_layer/ class=md-nav__link> <span class=md-ellipsis> REST API Layer </span> </a> </li> <li class=md-nav__item> <a href=../cli_layer/ class=md-nav__link> <span class=md-ellipsis> CLI Layer </span> </a> </li> <li class=md-nav__item> <a href=../library_layer/ class=md-nav__link> <span class=md-ellipsis> Library Layer </span> </a> </li> <li class=md-nav__item> <a href=../logging/ class=md-nav__link> <span class=md-ellipsis> Logging </span> </a> </li> <li class=md-nav__item> <a href=../decisions/ class=md-nav__link> <span class=md-ellipsis> Architecture Decisions </span> </a> </li> <li class=md-nav__item> <a href=../extending/ class=md-nav__link> <span class=md-ellipsis> Extending </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api_reference/ class=md-nav__link> <span class=md-ellipsis> API Reference Overview </span> </a> </li> <li class=md-nav__item> <a href=../../api_reference/optics/ class=md-nav__link> <span class=md-ellipsis> Optics Class </span> </a> </li> <li class=md-nav__item> <a href=../../api_reference/action_keywords/ class=md-nav__link> <span class=md-ellipsis> Action Keywords </span> </a> </li> <li class=md-nav__item> <a href=../../api_reference/app_management/ class=md-nav__link> <span class=md-ellipsis> App Management </span> </a> </li> <li class=md-nav__item> <a href=../../api_reference/verification/ class=md-nav__link> <span class=md-ellipsis> Verification </span> </a> </li> <li class=md-nav__item> <a href=../../api_reference/flow_control/ class=md-nav__link> <span class=md-ellipsis> Flow Control </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Contribution </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Contribution </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contribution/contributing_guidelines/ class=md-nav__link> <span class=md-ellipsis> Contributing Guidelines </span> </a> </li> <li class=md-nav__item> <a href=../../contribution/developer_guide/ class=md-nav__link> <span class=md-ellipsis> Developer Guide </span> </a> </li> <li class=md-nav__item> <a href=../../contribution/help_wanted/ class=md-nav__link> <span class=md-ellipsis> Help Wanted </span> </a> </li> <li class=md-nav__item> <a href=../../contribution/code_of_conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#core-components class=md-nav__link> <span class=md-ellipsis> Core Components </span> </a> <nav class=md-nav aria-label="Core Components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#optics-class class=md-nav__link> <span class=md-ellipsis> Optics Class </span> </a> </li> <li class=md-nav__item> <a href=#sessionmanager class=md-nav__link> <span class=md-ellipsis> SessionManager </span> </a> </li> <li class=md-nav__item> <a href=#opticsbuilder class=md-nav__link> <span class=md-ellipsis> OpticsBuilder </span> </a> </li> <li class=md-nav__item> <a href=#confighandler class=md-nav__link> <span class=md-ellipsis> ConfigHandler </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#factory-system class=md-nav__link> <span class=md-ellipsis> Factory System </span> </a> <nav class=md-nav aria-label="Factory System"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#genericfactory class=md-nav__link> <span class=md-ellipsis> GenericFactory </span> </a> </li> <li class=md-nav__item> <a href=#devicefactory class=md-nav__link> <span class=md-ellipsis> DeviceFactory </span> </a> </li> <li class=md-nav__item> <a href=#elementsourcefactory class=md-nav__link> <span class=md-ellipsis> ElementSourceFactory </span> </a> </li> <li class=md-nav__item> <a href=#imagefactory-and-textfactory class=md-nav__link> <span class=md-ellipsis> ImageFactory and TextFactory </span> </a> </li> <li class=md-nav__item> <a href=#instancefallback_1 class=md-nav__link> <span class=md-ellipsis> InstanceFallback </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#interfaces class=md-nav__link> <span class=md-ellipsis> Interfaces </span> </a> <nav class=md-nav aria-label=Interfaces> <ul class=md-nav__list> <li class=md-nav__item> <a href=#driverinterface class=md-nav__link> <span class=md-ellipsis> DriverInterface </span> </a> </li> <li class=md-nav__item> <a href=#elementsourceinterface class=md-nav__link> <span class=md-ellipsis> ElementSourceInterface </span> </a> </li> <li class=md-nav__item> <a href=#imageinterface class=md-nav__link> <span class=md-ellipsis> ImageInterface </span> </a> </li> <li class=md-nav__item> <a href=#textinterface class=md-nav__link> <span class=md-ellipsis> TextInterface </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#api-modules class=md-nav__link> <span class=md-ellipsis> API Modules </span> </a> <nav class=md-nav aria-label="API Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#actionkeyword class=md-nav__link> <span class=md-ellipsis> ActionKeyword </span> </a> </li> <li class=md-nav__item> <a href=#appmanagement class=md-nav__link> <span class=md-ellipsis> AppManagement </span> </a> </li> <li class=md-nav__item> <a href=#verifier class=md-nav__link> <span class=md-ellipsis> Verifier </span> </a> </li> <li class=md-nav__item> <a href=#flowcontrol class=md-nav__link> <span class=md-ellipsis> FlowControl </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#component-interactions class=md-nav__link> <span class=md-ellipsis> Component Interactions </span> </a> <nav class=md-nav aria-label="Component Interactions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#initialization-flow class=md-nav__link> <span class=md-ellipsis> Initialization Flow </span> </a> </li> <li class=md-nav__item> <a href=#action-execution-flow class=md-nav__link> <span class=md-ellipsis> Action Execution Flow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#extension-points class=md-nav__link> <span class=md-ellipsis> Extension Points </span> </a> <nav class=md-nav aria-label="Extension Points"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adding-a-new-driver class=md-nav__link> <span class=md-ellipsis> Adding a New Driver </span> </a> </li> <li class=md-nav__item> <a href=#adding-a-new-element-source class=md-nav__link> <span class=md-ellipsis> Adding a New Element Source </span> </a> </li> <li class=md-nav__item> <a href=#adding-a-new-vision-model class=md-nav__link> <span class=md-ellipsis> Adding a New Vision Model </span> </a> </li> <li class=md-nav__item> <a href=#adding-a-new-keyword class=md-nav__link> <span class=md-ellipsis> Adding a New Keyword </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#related-documentation class=md-nav__link> <span class=md-ellipsis> Related Documentation </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=component-architecture>Component Architecture<a class=headerlink href=#component-architecture title="Permanent link">&para;</a></h1> <p>This document provides detailed documentation of all major components in the Optics Framework, their responsibilities, and how they interact.</p> <h2 id=core-components>Core Components<a class=headerlink href=#core-components title="Permanent link">&para;</a></h2> <h3 id=optics-class>Optics Class<a class=headerlink href=#optics-class title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/optics.py</code></p> <p>The <code>Optics</code> class is the main entry point for the framework. It provides a unified interface for both programmatic use and Robot Framework integration.</p> <h4 id=key-responsibilities>Key Responsibilities<a class=headerlink href=#key-responsibilities title="Permanent link">&para;</a></h4> <ul> <li>Configuration parsing and validation</li> <li>Session lifecycle management</li> <li>Keyword registration and exposure</li> <li>Template discovery</li> <li>Element and API data management</li> </ul> <h4 id=key-methods>Key Methods<a class=headerlink href=#key-methods title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nd>@keyword</span><span class=p>(</span><span class=s2>&quot;Setup&quot;</span><span class=p>)</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=k>def</span><span class=w> </span><span class=nf>setup</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=kc>None</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configure the framework with driver and element source settings.&quot;&quot;&quot;</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=nd>@keyword</span><span class=p>(</span><span class=s2>&quot;Press Element&quot;</span><span class=p>)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=nd>@fallback_params</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=k>def</span><span class=w> </span><span class=nf>press_element</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>element</span><span class=p>:</span> <span class=n>fallback_str</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Press an element with automatic fallback support.&quot;&quot;&quot;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=nd>@keyword</span><span class=p>(</span><span class=s2>&quot;Add Element&quot;</span><span class=p>)</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=k>def</span><span class=w> </span><span class=nf>add_element</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Add or update an element in the current session.&quot;&quot;&quot;</span>
</span></code></pre></div> <h4 id=architecture-notes>Architecture Notes<a class=headerlink href=#architecture-notes title="Permanent link">&para;</a></h4> <ul> <li>Uses <code>@fallback_params</code> decorator to support multiple fallback values</li> <li>Integrates with Robot Framework when available</li> <li>Manages session state through <code>SessionManager</code></li> <li>Delegates actual execution to API classes (ActionKeyword, Verifier, etc.)</li> </ul> <h4 id=fallback-parameter-system>Fallback Parameter System<a class=headerlink href=#fallback-parameter-system title="Permanent link">&para;</a></h4> <p>The Optics Framework provides a sophisticated fallback parameter system that allows keywords to automatically try multiple values until one succeeds. This is particularly useful for element location where multiple strategies or identifiers might work.</p> <h5 id=how-it-works>How It Works<a class=headerlink href=#how-it-works title="Permanent link">&para;</a></h5> <p>The <code>@fallback_params</code> decorator enables automatic fallback for parameters typed as <code>fallback_str</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>optics_framework.optics</span><span class=w> </span><span class=kn>import</span> <span class=n>fallback_str</span><span class=p>,</span> <span class=n>fallback_params</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=nd>@keyword</span><span class=p>(</span><span class=s2>&quot;Press Element&quot;</span><span class=p>)</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=nd>@fallback_params</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=k>def</span><span class=w> </span><span class=nf>press_element</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>element</span><span class=p>:</span> <span class=n>fallback_str</span><span class=p>,</span> <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>30</span><span class=p>):</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Press an element, trying multiple values if needed.&quot;&quot;&quot;</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=c1># Implementation</span>
</span></code></pre></div> <p><strong>Type Definition:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>fallback_str</span> <span class=o>=</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span>
</span></code></pre></div></p> <h5 id=parameter-normalization>Parameter Normalization<a class=headerlink href=#parameter-normalization title="Permanent link">&para;</a></h5> <p>The decorator normalizes fallback values:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>def</span><span class=w> </span><span class=nf>_normalize_fallback_values</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>val</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=sd>    Normalize fallback parameter values.</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=sd>    - str -&gt; [str] (single value)</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=sd>    - List[str] -&gt; List[str] (multiple values)</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=sd>    - None -&gt; [] (empty, skipped)</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=sd>    - Empty list -&gt; ValueError</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=sd>    &quot;&quot;&quot;</span>
</span></code></pre></div> <p><strong>Examples:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Single value (no fallback)</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>press_element</span><span class=p>(</span><span class=s2>&quot;submit_button&quot;</span><span class=p>)</span>  <span class=c1># element = [&quot;submit_button&quot;]</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1># Multiple values (fallback)</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=n>press_element</span><span class=p>([</span><span class=s2>&quot;submit_btn&quot;</span><span class=p>,</span> <span class=s2>&quot;submit_button&quot;</span><span class=p>,</span> <span class=s2>&quot;//button[@id=&#39;submit&#39;]&quot;</span><span class=p>])</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=c1># Tries each value in order until one succeeds</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=c1># Mixed parameters</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=n>press_element</span><span class=p>([</span><span class=s2>&quot;btn1&quot;</span><span class=p>,</span> <span class=s2>&quot;btn2&quot;</span><span class=p>],</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span>  <span class=c1># Only element has fallback</span>
</span></code></pre></div></p> <h5 id=combination-generation>Combination Generation<a class=headerlink href=#combination-generation title="Permanent link">&para;</a></h5> <p>When multiple parameters have fallback values, all combinations are tried:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kn>from</span><span class=w> </span><span class=nn>itertools</span><span class=w> </span><span class=kn>import</span> <span class=n>product</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=c1># Generate all combinations</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=k>for</span> <span class=n>combo</span> <span class=ow>in</span> <span class=n>product</span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>fallback_lists</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>keys</span><span class=p>)):</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=n>combo_kwargs</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>keys</span><span class=p>,</span> <span class=n>combo</span><span class=p>))</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>        <span class=k>return</span> <span class=n>func</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=o>**</span><span class=n>combo_kwargs</span><span class=p>)</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>        <span class=k>continue</span>  <span class=c1># Try next combination</span>
</span></code></pre></div> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nd>@fallback_params</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>def</span><span class=w> </span><span class=nf>press_element</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>element</span><span class=p>:</span> <span class=n>fallback_str</span><span class=p>,</span> <span class=n>area</span><span class=p>:</span> <span class=n>fallback_str</span><span class=p>):</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=k>pass</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=c1># Called with:</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>press_element</span><span class=p>([</span><span class=s2>&quot;btn1&quot;</span><span class=p>,</span> <span class=s2>&quot;btn2&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;area1&quot;</span><span class=p>,</span> <span class=s2>&quot;area2&quot;</span><span class=p>])</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=c1># Tries:</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=c1># 1. element=&quot;btn1&quot;, area=&quot;area1&quot;</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=c1># 2. element=&quot;btn1&quot;, area=&quot;area2&quot;</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=c1># 3. element=&quot;btn2&quot;, area=&quot;area1&quot;</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=c1># 4. element=&quot;btn2&quot;, area=&quot;area2&quot;</span>
</span></code></pre></div></p> <h5 id=error-aggregation>Error Aggregation<a class=headerlink href=#error-aggregation title="Permanent link">&para;</a></h5> <p>If all fallback attempts fail, errors are aggregated:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>if</span> <span class=n>errors</span><span class=p>:</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=n>msg</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>err</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>c</span><span class=p>,</span> <span class=n>err</span> <span class=ow>in</span> <span class=n>errors</span><span class=p>])</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>        <span class=sa>f</span><span class=s2>&quot;All fallback attempts failed in </span><span class=si>{</span><span class=n>func</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>:</span><span class=se>\n</span><span class=si>{</span><span class=n>msg</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=p>)</span>
</span></code></pre></div> <p><strong>Error Message Format:</strong> <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>All fallback attempts failed in press_element:
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>{&#39;element&#39;: &#39;btn1&#39;} -&gt; Element not found
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>{&#39;element&#39;: &#39;btn2&#39;} -&gt; Element not found
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>{&#39;element&#39;: &#39;btn3&#39;} -&gt; Timeout exceeded
</span></code></pre></div></p> <h5 id=integration-with-api-layer>Integration with API Layer<a class=headerlink href=#integration-with-api-layer title="Permanent link">&para;</a></h5> <p>The REST API layer also supports fallback parameters:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># API request with fallback</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=p>{</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>  <span class=s2>&quot;keyword&quot;</span><span class=p>:</span> <span class=s2>&quot;Press Element&quot;</span><span class=p>,</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>  <span class=s2>&quot;params&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;btn1&quot;</span><span class=p>,</span> <span class=s2>&quot;btn2&quot;</span><span class=p>,</span> <span class=s2>&quot;btn3&quot;</span><span class=p>]</span>  <span class=c1># Positional fallback</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=p>}</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=c1># Or named parameters with fallback</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=p>{</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>  <span class=s2>&quot;keyword&quot;</span><span class=p>:</span> <span class=s2>&quot;Press Element&quot;</span><span class=p>,</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>  <span class=s2>&quot;params&quot;</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>    <span class=s2>&quot;element&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;btn1&quot;</span><span class=p>,</span> <span class=s2>&quot;btn2&quot;</span><span class=p>],</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>    <span class=s2>&quot;timeout&quot;</span><span class=p>:</span> <span class=s2>&quot;30&quot;</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>  <span class=p>}</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=p>}</span>
</span></code></pre></div> <p>The API uses the same combination generation logic:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>_execute_keyword_with_fallback</span><span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=n>engine</span><span class=p>:</span> <span class=n>ExecutionEngine</span><span class=p>,</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>session_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>keyword</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=n>params</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]],</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]]],</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=n>method</span><span class=p>:</span> <span class=n>Callable</span><span class=p>[</span><span class=o>...</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>session</span><span class=p>:</span> <span class=n>Session</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=c1># Normalize parameters</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>    <span class=c1># Generate combinations</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>    <span class=c1># Try each combination</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>    <span class=c1># Aggregate errors</span>
</span></code></pre></div> <h5 id=use-cases>Use Cases<a class=headerlink href=#use-cases title="Permanent link">&para;</a></h5> <p><strong>1. Element Location Fallback:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Try multiple element identifiers</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=n>press_element</span><span class=p>([</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>    <span class=s2>&quot;//button[@id=&#39;submit&#39;]&quot;</span><span class=p>,</span>      <span class=c1># XPath</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=s2>&quot;Submit Button&quot;</span><span class=p>,</span>                <span class=c1># Text</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>    <span class=s2>&quot;submit_template.png&quot;</span>           <span class=c1># Image template</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=p>])</span>
</span></code></pre></div></p> <p><strong>2. Multiple Strategies:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Try different approaches</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=n>enter_text</span><span class=p>([</span><span class=s2>&quot;username&quot;</span><span class=p>,</span> <span class=s2>&quot;user_name&quot;</span><span class=p>,</span> <span class=s2>&quot;//input[@name=&#39;user&#39;]&quot;</span><span class=p>],</span> <span class=s2>&quot;testuser&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>3. Environment-Specific Values:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># Different values for different environments</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=n>launch_app</span><span class=p>([</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>    <span class=s2>&quot;com.example.app.dev&quot;</span><span class=p>,</span>      <span class=c1># Development</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>    <span class=s2>&quot;com.example.app.staging&quot;</span><span class=p>,</span>  <span class=c1># Staging</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>    <span class=s2>&quot;com.example.app.prod&quot;</span>      <span class=c1># Production</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=p>])</span>
</span></code></pre></div></p> <h5 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h5> <ol> <li><strong>Order Matters</strong>: Place most likely to succeed values first</li> <li><strong>Limit Combinations</strong>: Avoid too many fallback values (exponential growth)</li> <li><strong>Meaningful Errors</strong>: Ensure errors provide context for debugging</li> <li><strong>Type Safety</strong>: Always use <code>fallback_str</code> type hint</li> <li><strong>Documentation</strong>: Document expected fallback behavior</li> </ol> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=nd>@keyword</span><span class=p>(</span><span class=s2>&quot;Press Element&quot;</span><span class=p>)</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=nd>@fallback_params</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=k>def</span><span class=w> </span><span class=nf>press_element</span><span class=p>(</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=bp>self</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=n>element</span><span class=p>:</span> <span class=n>fallback_str</span><span class=p>,</span>  <span class=c1># Document: &quot;Tries XPath, text, then image&quot;</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>    <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>30</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=sd>    Press an element with automatic fallback.</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=sd>    Args:</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=sd>        element: Element identifier(s). Can be:</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=sd>            - Single string: One identifier</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=sd>            - List of strings: Multiple fallback identifiers</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=sd>            Tries each in order until one succeeds.</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=sd>        timeout: Maximum time to wait for element</span>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=sd>    &quot;&quot;&quot;</span>
</span></code></pre></div></p> <h5 id=performance-considerations>Performance Considerations<a class=headerlink href=#performance-considerations title="Permanent link">&para;</a></h5> <ul> <li><strong>Early Exit</strong>: Decorator stops on first success</li> <li><strong>Error Handling</strong>: Only catches non-critical exceptions</li> <li><strong>Combination Limit</strong>: Consider limiting combinations for performance</li> <li><strong>Caching</strong>: Results may be cached by strategy layer</li> </ul> <h5 id=limitations>Limitations<a class=headerlink href=#limitations title="Permanent link">&para;</a></h5> <ul> <li><strong>Type Restriction</strong>: Only works with <code>fallback_str</code> type</li> <li><strong>Exception Handling</strong>: SystemExit, KeyboardInterrupt, GeneratorExit are re-raised</li> <li><strong>No Partial Success</strong>: All parameters must succeed together</li> <li><strong>Error Visibility</strong>: Individual attempt errors are aggregated</li> </ul> <h3 id=sessionmanager>SessionManager<a class=headerlink href=#sessionmanager title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/session_manager.py</code></p> <p>Manages the lifecycle of test execution sessions, including creation, retrieval, and termination with proper resource management and cleanup.</p> <h4 id=key-responsibilities_1>Key Responsibilities<a class=headerlink href=#key-responsibilities_1 title="Permanent link">&para;</a></h4> <ul> <li>Session creation with unique IDs</li> <li>Session storage and retrieval</li> <li>Resource cleanup on termination</li> <li>Session-scoped configuration management</li> <li>Event manager lifecycle</li> <li>Driver lifecycle management</li> </ul> <h4 id=class-structure>Class Structure<a class=headerlink href=#class-structure title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=k>class</span><span class=w> </span><span class=nc>SessionManager</span><span class=p>(</span><span class=n>SessionHandler</span><span class=p>):</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>        <span class=bp>self</span><span class=o>.</span><span class=n>sessions</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Session</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>    <span class=k>def</span><span class=w> </span><span class=nf>create_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>Config</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Creates a new session with a unique ID.&quot;&quot;&quot;</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>session_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Session</span><span class=p>]:</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Retrieves a session by ID.&quot;&quot;&quot;</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>    <span class=k>def</span><span class=w> </span><span class=nf>terminate_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>session_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Terminates a session and cleans up resources.&quot;&quot;&quot;</span>
</span></code></pre></div> <h4 id=session-lifecycle>Session Lifecycle<a class=headerlink href=#session-lifecycle title="Permanent link">&para;</a></h4> <pre class=mermaid><code>stateDiagram-v2
    [*] --&gt; Creating: create_session()
    Creating --&gt; Active: Session created
    Active --&gt; Executing: Test execution
    Executing --&gt; Active: Execution complete
    Active --&gt; Terminating: terminate_session()
    Terminating --&gt; [*]: Cleanup complete

    Active --&gt; Error: Error occurred
    Error --&gt; Terminating: Cleanup</code></pre> <h4 id=session-creation-flow>Session Creation Flow<a class=headerlink href=#session-creation-flow title="Permanent link">&para;</a></h4> <pre class=mermaid><code>sequenceDiagram
    participant Client
    participant SessionMgr
    participant Session
    participant ConfigHandler
    participant Builder
    participant Driver
    participant EventSDK

    Client-&gt;&gt;SessionMgr: create_session(config, ...)
    SessionMgr-&gt;&gt;SessionMgr: Generate UUID
    SessionMgr-&gt;&gt;Session: new Session(id, config, ...)
    Session-&gt;&gt;ConfigHandler: new ConfigHandler(config)
    Session-&gt;&gt;Session: Extract enabled dependencies
    Session-&gt;&gt;EventSDK: new EventSDK(config_handler)
    Session-&gt;&gt;Builder: new OpticsBuilder(session)
    Session-&gt;&gt;Builder: add_driver(configs)
    Session-&gt;&gt;Builder: add_element_source(configs)
    Session-&gt;&gt;Builder: add_text_detection(configs)
    Session-&gt;&gt;Builder: add_image_detection(configs)
    Session-&gt;&gt;Builder: get_driver()
    Builder-&gt;&gt;Driver: Create driver instance
    Driver--&gt;&gt;Builder: driver instance
    Builder--&gt;&gt;Session: driver
    Session-&gt;&gt;Session: Setup event queue
    Session--&gt;&gt;SessionMgr: Session ready
    SessionMgr--&gt;&gt;Client: session_id</code></pre> <h4 id=session-class>Session Class<a class=headerlink href=#session-class title="Permanent link">&para;</a></h4> <p>Each <code>Session</code> instance contains:</p> <p><strong>Core Attributes:</strong></p> <ul> <li><code>session_id</code>: Unique identifier (UUID)</li> <li><code>config_handler</code>: Configuration handler instance</li> <li><code>config</code>: Configuration object</li> <li><code>test_cases</code>: Test case data structure</li> <li><code>modules</code>: Reusable module definitions</li> <li><code>elements</code>: Element definitions and values</li> <li><code>apis</code>: API endpoint definitions</li> <li><code>templates</code>: Image template mappings</li> </ul> <p><strong>Component Instances:</strong></p> <ul> <li><code>optics</code>: OpticsBuilder instance</li> <li><code>driver</code>: Driver instance (via fallback)</li> <li><code>event_sdk</code>: Event tracking SDK</li> <li><code>event_queue</code>: Async queue for execution events</li> </ul> <h4 id=session-initialization>Session Initialization<a class=headerlink href=#session-initialization title="Permanent link">&para;</a></h4> <p>During session creation, the following occurs:</p> <ol> <li> <p><strong>Configuration Setup:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=bp>self</span><span class=o>.</span><span class=n>config_handler</span> <span class=o>=</span> <span class=n>ConfigHandler</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config_handler</span><span class=o>.</span><span class=n>config</span>
</span></code></pre></div></p> </li> <li> <p><strong>Dependency Extraction:</strong></p> </li> <li> <p>Extract enabled driver configurations</p> </li> <li>Extract enabled element source configurations</li> <li>Extract enabled text detection configurations</li> <li> <p>Extract enabled image detection configurations</p> </li> <li> <p><strong>Component Initialization:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=bp>self</span><span class=o>.</span><span class=n>event_sdk</span> <span class=o>=</span> <span class=n>EventSDK</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config_handler</span><span class=p>)</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=bp>self</span><span class=o>.</span><span class=n>optics</span> <span class=o>=</span> <span class=n>OpticsBuilder</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=bp>self</span><span class=o>.</span><span class=n>optics</span><span class=o>.</span><span class=n>add_driver</span><span class=p>(</span><span class=n>enabled_driver_configs</span><span class=p>)</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=bp>self</span><span class=o>.</span><span class=n>optics</span><span class=o>.</span><span class=n>add_element_source</span><span class=p>(</span><span class=n>enabled_element_configs</span><span class=p>)</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=bp>self</span><span class=o>.</span><span class=n>optics</span><span class=o>.</span><span class=n>add_text_detection</span><span class=p>(</span><span class=n>enabled_text_configs</span><span class=p>)</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=bp>self</span><span class=o>.</span><span class=n>optics</span><span class=o>.</span><span class=n>add_image_detection</span><span class=p>(</span><span class=n>enabled_image_configs</span><span class=p>)</span>
</span></code></pre></div></p> </li> <li> <p><strong>Driver Initialization:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=bp>self</span><span class=o>.</span><span class=n>driver</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>optics</span><span class=o>.</span><span class=n>get_driver</span><span class=p>()</span>
</span></code></pre></div></p> </li> <li> <p><strong>Event Queue Setup:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=bp>self</span><span class=o>.</span><span class=n>event_queue</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Queue</span><span class=p>()</span>
</span></code></pre></div></p> </li> </ol> <h4 id=session-state-transitions>Session State Transitions<a class=headerlink href=#session-state-transitions title="Permanent link">&para;</a></h4> <p><strong>Creating State:</strong></p> <ul> <li>Session ID generated</li> <li>Configuration loaded</li> <li>Components initialized</li> <li>Driver connection established</li> </ul> <p><strong>Active State:</strong></p> <ul> <li>Session ready for execution</li> <li>Driver connected</li> <li>Event queue ready</li> <li>All components initialized</li> </ul> <p><strong>Executing State:</strong></p> <ul> <li>Test cases being executed</li> <li>Events being published</li> <li>Driver performing actions</li> </ul> <p><strong>Terminating State:</strong></p> <ul> <li>Driver termination initiated</li> <li>Event manager cleanup</li> <li>JUnit handler cleanup</li> <li>Session removal from registry</li> </ul> <h4 id=session-termination>Session Termination<a class=headerlink href=#session-termination title="Permanent link">&para;</a></h4> <p>Session termination performs comprehensive cleanup:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>def</span><span class=w> </span><span class=nf>terminate_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>session_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>    <span class=n>session</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>sessions</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>session_id</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>    <span class=k>if</span> <span class=n>session</span> <span class=ow>and</span> <span class=n>session</span><span class=o>.</span><span class=n>driver</span><span class=p>:</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>        <span class=n>session</span><span class=o>.</span><span class=n>driver</span><span class=o>.</span><span class=n>terminate</span><span class=p>()</span>  <span class=c1># Close driver connection</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>    <span class=n>cleanup_junit</span><span class=p>(</span><span class=n>session_id</span><span class=p>)</span>  <span class=c1># Cleanup JUnit reports</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>    <span class=n>get_event_manager_registry</span><span class=p>()</span><span class=o>.</span><span class=n>remove_session</span><span class=p>(</span><span class=n>session_id</span><span class=p>)</span>  <span class=c1># Remove event manager</span>
</span></code></pre></div> <p><strong>Cleanup Steps:</strong></p> <ol> <li><strong>Remove from Registry</strong>: Remove session from sessions dictionary</li> <li><strong>Driver Termination</strong>: Call <code>driver.terminate()</code> to close connections</li> <li><strong>JUnit Cleanup</strong>: Cleanup JUnit report handlers</li> <li><strong>Event Manager Cleanup</strong>: Remove event manager for session</li> </ol> <h4 id=resource-management>Resource Management<a class=headerlink href=#resource-management title="Permanent link">&para;</a></h4> <p><strong>Driver Resources:</strong></p> <ul> <li>WebDriver connections</li> <li>Appium sessions</li> <li>Browser instances</li> <li>Device connections</li> </ul> <p><strong>Event Resources:</strong></p> <ul> <li>Event queues</li> <li>Event subscribers</li> <li>JUnit handlers</li> </ul> <p><strong>File Resources:</strong></p> <ul> <li>Log files</li> <li>Screenshot files</li> <li>Execution output</li> </ul> <h4 id=session-isolation>Session Isolation<a class=headerlink href=#session-isolation title="Permanent link">&para;</a></h4> <p>Sessions are isolated from each other:</p> <ul> <li><strong>Separate Configuration</strong>: Each session has its own configuration</li> <li><strong>Separate Drivers</strong>: Each session has its own driver instance</li> <li><strong>Separate Event Queues</strong>: Each session has its own event queue</li> <li><strong>Separate State</strong>: Test cases, elements, modules are session-scoped</li> </ul> <h4 id=concurrency-considerations>Concurrency Considerations<a class=headerlink href=#concurrency-considerations title="Permanent link">&para;</a></h4> <p><strong>Current Implementation:</strong></p> <ul> <li>Sessions are stored in a dictionary (not thread-safe for writes)</li> <li>Each session has its own driver instance</li> <li>Event queues are per-session</li> </ul> <p><strong>Best Practices:</strong></p> <ul> <li>Create separate sessions for concurrent execution</li> <li>Don't share sessions between threads</li> <li>Terminate sessions when done</li> </ul> <h4 id=session-retrieval>Session Retrieval<a class=headerlink href=#session-retrieval title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=k>def</span><span class=w> </span><span class=nf>get_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>session_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Session</span><span class=p>]:</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieves a session by ID, or None if not found.&quot;&quot;&quot;</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>sessions</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>session_id</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Usage:</strong></p> <ul> <li>Returns <code>None</code> if session doesn't exist</li> <li>Returns <code>Session</code> instance if found</li> <li>No locking required (read-only operation)</li> </ul> <h4 id=session-validation>Session Validation<a class=headerlink href=#session-validation title="Permanent link">&para;</a></h4> <p>During session creation, validation occurs:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>if</span> <span class=ow>not</span> <span class=n>enabled_driver_configs</span><span class=p>:</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>    <span class=k>raise</span> <span class=n>OpticsError</span><span class=p>(</span><span class=n>Code</span><span class=o>.</span><span class=n>E0501</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=s2>&quot;No enabled drivers found&quot;</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Validations:</strong></p> <ul> <li>At least one driver must be enabled</li> <li>Configuration must be valid</li> <li>Dependencies must be properly configured</li> </ul> <h4 id=error-recovery>Error Recovery<a class=headerlink href=#error-recovery title="Permanent link">&para;</a></h4> <p><strong>Session Creation Errors:</strong></p> <ul> <li>Configuration errors are raised immediately</li> <li>Driver initialization errors are propagated</li> <li>Partial initialization is cleaned up</li> </ul> <p><strong>Session Termination Errors:</strong></p> <ul> <li>Driver termination errors are logged but don't stop cleanup</li> <li>Event manager cleanup errors are logged</li> <li>Session is always removed from registry</li> </ul> <h4 id=session-persistence>Session Persistence<a class=headerlink href=#session-persistence title="Permanent link">&para;</a></h4> <p><strong>Current Implementation:</strong></p> <ul> <li>Sessions are stored in memory only</li> <li>No persistence to disk</li> <li>Sessions are lost on process termination</li> </ul> <p><strong>Future Considerations:</strong></p> <ul> <li>Session serialization for persistence</li> <li>Session recovery on restart</li> <li>Session state snapshots</li> </ul> <h4 id=best-practices_1>Best Practices<a class=headerlink href=#best-practices_1 title="Permanent link">&para;</a></h4> <ol> <li><strong>Always Terminate Sessions</strong>: Call <code>terminate_session()</code> when done</li> <li><strong>One Session Per Test Run</strong>: Create a new session for each test run</li> <li><strong>Reuse Sessions Within Run</strong>: Reuse session for multiple test cases in same run</li> <li><strong>Handle Termination Errors</strong>: Wrap termination in try/except</li> <li><strong>Check Session Existence</strong>: Verify session exists before use</li> </ol> <h4 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h4> <p><strong>Session Not Found:</strong></p> <ul> <li>Verify session ID is correct</li> <li>Check session hasn't been terminated</li> <li>Ensure session was created successfully</li> </ul> <p><strong>Driver Not Initialized:</strong></p> <ul> <li>Check at least one driver is enabled</li> <li>Verify driver configuration is correct</li> <li>Review driver initialization logs</li> </ul> <p><strong>Resource Leaks:</strong></p> <ul> <li>Ensure <code>terminate_session()</code> is called</li> <li>Check for exception handling that skips cleanup</li> <li>Review driver termination logs</li> </ul> <h3 id=opticsbuilder>OpticsBuilder<a class=headerlink href=#opticsbuilder title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/optics_builder.py</code></p> <p>Implements the Builder pattern to construct complex component hierarchies with proper dependency injection.</p> <h4 id=key-responsibilities_2>Key Responsibilities<a class=headerlink href=#key-responsibilities_2 title="Permanent link">&para;</a></h4> <ul> <li>Configuration normalization</li> <li>Component instantiation through factories</li> <li>Dependency management between components</li> <li>Lazy instantiation of components</li> </ul> <h4 id=builder-flow>Builder Flow<a class=headerlink href=#builder-flow title="Permanent link">&para;</a></h4> <pre class=mermaid><code>graph LR
    A[OpticsBuilder] --&gt; B[add_driver]
    A --&gt; C[add_element_source]
    A --&gt; D[add_image_detection]
    A --&gt; E[add_text_detection]
    B --&gt; F[instantiate_driver]
    C --&gt; G[instantiate_element_source]
    D --&gt; H[instantiate_image_detection]
    E --&gt; I[instantiate_text_detection]
    F --&gt; J[DeviceFactory]
    G --&gt; K[ElementSourceFactory]
    H --&gt; L[ImageFactory]
    I --&gt; M[TextFactory]</code></pre> <h4 id=key-methods_1>Key Methods<a class=headerlink href=#key-methods_1 title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=k>def</span><span class=w> </span><span class=nf>add_driver</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>]]])</span> <span class=o>-&gt;</span> <span class=s2>&quot;OpticsBuilder&quot;</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Add driver configuration.&quot;&quot;&quot;</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=k>def</span><span class=w> </span><span class=nf>add_element_source</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Dict</span><span class=p>]]])</span> <span class=o>-&gt;</span> <span class=s2>&quot;OpticsBuilder&quot;</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Add element source configuration.&quot;&quot;&quot;</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=k>def</span><span class=w> </span><span class=nf>build</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>T</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>T</span><span class=p>:</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Build an instance of the specified class using stored configurations.&quot;&quot;&quot;</span>
</span></code></pre></div> <h4 id=usage-example>Usage Example<a class=headerlink href=#usage-example title="Permanent link">&para;</a></h4> <p><strong>Basic Builder Usage:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=kn>from</span><span class=w> </span><span class=nn>optics_framework.common.optics_builder</span><span class=w> </span><span class=kn>import</span> <span class=n>OpticsBuilder</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=c1># Create builder</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=n>builder</span> <span class=o>=</span> <span class=n>OpticsBuilder</span><span class=p>(</span><span class=n>session</span><span class=p>)</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=c1># Add components</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=n>builder</span><span class=o>.</span><span class=n>add_driver</span><span class=p>([{</span><span class=s2>&quot;appium&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>:</span> <span class=s2>&quot;...&quot;</span><span class=p>}}])</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=n>builder</span><span class=o>.</span><span class=n>add_element_source</span><span class=p>([{</span><span class=s2>&quot;appium_find_element&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=n>builder</span><span class=o>.</span><span class=n>add_text_detection</span><span class=p>([{</span><span class=s2>&quot;easyocr&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=n>builder</span><span class=o>.</span><span class=n>add_image_detection</span><span class=p>([{</span><span class=s2>&quot;templatematch&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=c1># Get components</span>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=n>driver</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>get_driver</span><span class=p>()</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=n>element_source</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>get_element_source</span><span class=p>()</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=n>text_detection</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>get_text_detection</span><span class=p>()</span>
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=n>image_detection</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>get_image_detection</span><span class=p>()</span>
</span></code></pre></div></p> <p><strong>Fluent API:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=c1># Builder supports method chaining</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=n>builder</span> <span class=o>=</span> <span class=p>(</span><span class=n>OpticsBuilder</span><span class=p>(</span><span class=n>session</span><span class=p>)</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>    <span class=o>.</span><span class=n>add_driver</span><span class=p>([{</span><span class=s2>&quot;appium&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>    <span class=o>.</span><span class=n>add_element_source</span><span class=p>([{</span><span class=s2>&quot;appium_find_element&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a>    <span class=o>.</span><span class=n>add_text_detection</span><span class=p>([{</span><span class=s2>&quot;easyocr&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Building API Classes:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c1># Build API classes with dependencies</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=n>action_keyword</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>build</span><span class=p>(</span><span class=n>ActionKeyword</span><span class=p>)</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=c1># ActionKeyword receives driver, element_source, strategy_manager, etc.</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=n>verifier</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>build</span><span class=p>(</span><span class=n>Verifier</span><span class=p>)</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=c1># Verifier receives builder components</span>
</span></code></pre></div></p> <h4 id=dependency-injection>Dependency Injection<a class=headerlink href=#dependency-injection title="Permanent link">&para;</a></h4> <p>The builder automatically injects dependencies:</p> <ul> <li>Element sources receive matching drivers</li> <li>Image detection receives project path and templates</li> <li>Text detection receives execution output path</li> </ul> <p><strong>Example - Element Source Injection:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># Element source automatically receives matching driver</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=n>builder</span><span class=o>.</span><span class=n>add_driver</span><span class=p>([{</span><span class=s2>&quot;appium&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=n>builder</span><span class=o>.</span><span class=n>add_element_source</span><span class=p>([{</span><span class=s2>&quot;appium_find_element&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}}])</span>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=c1># When element source is created:</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=c1># ElementSourceFactory matches appium_find_element with appium driver</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=c1># Injects driver into element source constructor</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=n>element_source</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>get_element_source</span><span class=p>()</span>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=c1># element_source.driver is the Appium driver instance</span>
</span></code></pre></div></p> <p><strong>Example - Vision Model Injection:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># Image detection receives project path and templates</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=n>builder</span><span class=o>.</span><span class=n>add_image_detection</span><span class=p>([{</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>    <span class=s2>&quot;templatematch&quot;</span><span class=p>:</span> <span class=p>{</span>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>        <span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>        <span class=s2>&quot;project_path&quot;</span><span class=p>:</span> <span class=s2>&quot;/path/to/project&quot;</span><span class=p>,</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>        <span class=s2>&quot;execution_output_path&quot;</span><span class=p>:</span> <span class=s2>&quot;/path/to/output&quot;</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>    <span class=p>}</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=p>}])</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=c1># Template data is automatically discovered and injected</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=n>image_detection</span> <span class=o>=</span> <span class=n>builder</span><span class=o>.</span><span class=n>get_image_detection</span><span class=p>()</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=c1># image_detection has access to templates from project_path</span>
</span></code></pre></div></p> <h3 id=confighandler>ConfigHandler<a class=headerlink href=#confighandler title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/config_handler.py</code></p> <p>Handles configuration parsing, validation, and access with support for hierarchical configuration and precedence rules.</p> <h4 id=key-responsibilities_3>Key Responsibilities<a class=headerlink href=#key-responsibilities_3 title="Permanent link">&para;</a></h4> <ul> <li>Configuration file parsing (JSON/YAML)</li> <li>Configuration validation using Pydantic</li> <li>Dependency configuration management</li> <li>Enabled/disabled state tracking</li> <li>Configuration hierarchy and precedence</li> <li>Configuration merging</li> </ul> <h4 id=configuration-structure>Configuration Structure<a class=headerlink href=#configuration-structure title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=k>class</span><span class=w> </span><span class=nc>Config</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>    <span class=c1># Driver and element sources</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>    <span class=n>driver_sources</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DependencyConfig</span><span class=p>]]</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>    <span class=n>elements_sources</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DependencyConfig</span><span class=p>]]</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>    <span class=n>image_detection</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DependencyConfig</span><span class=p>]]]</span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>    <span class=n>text_detection</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>DependencyConfig</span><span class=p>]]]</span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>    <span class=c1># Paths</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>    <span class=n>project_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>    <span class=n>execution_output_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a>    <span class=c1># Logging</span>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a>    <span class=n>console</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a>    <span class=n>file_log</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a>    <span class=n>json_log</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a>    <span class=n>json_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a>    <span class=n>log_level</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;INFO&quot;</span>
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a>    <span class=n>log_path</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a>
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a>    <span class=c1># Execution</span>
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>    <span class=n>include</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-29-22><a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a>    <span class=n>exclude</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-29-23><a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a>    <span class=n>halt_duration</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.1</span>
</span><span id=__span-29-24><a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a>    <span class=n>max_attempts</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span>
</span><span id=__span-29-25><a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a>
</span><span id=__span-29-26><a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a>    <span class=c1># Events</span>
</span><span id=__span-29-27><a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a>    <span class=n>event_attributes_json</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></code></pre></div> <h4 id=dependencyconfig>DependencyConfig<a class=headerlink href=#dependencyconfig title="Permanent link">&para;</a></h4> <p>Each dependency has its own configuration:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=k>class</span><span class=w> </span><span class=nc>DependencyConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>    <span class=n>enabled</span><span class=p>:</span> <span class=nb>bool</span>  <span class=c1># Whether this dependency is enabled</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>    <span class=n>url</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># Connection URL (for drivers)</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>    <span class=n>capabilities</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># Dependency-specific settings</span>
</span></code></pre></div> <h4 id=configuration-hierarchy>Configuration Hierarchy<a class=headerlink href=#configuration-hierarchy title="Permanent link">&para;</a></h4> <p>Configuration is loaded from multiple sources with precedence:</p> <pre class=mermaid><code>graph TB
    A[Default Config] --&gt; B[Global Config]
    B --&gt; C[Project Config]
    C --&gt; D[Final Config]

    A1[Hardcoded Defaults] --&gt; A
    B1[~/.optics/global_config.yaml] --&gt; B
    C1[Project config.yaml] --&gt; C</code></pre> <p><strong>Precedence Order (highest to lowest):</strong></p> <ol> <li><strong>Project Config</strong> - Project-specific configuration</li> <li><strong>Global Config</strong> - User's global configuration (<code>~/.optics/global_config.yaml</code>)</li> <li><strong>Default Config</strong> - Framework defaults</li> </ol> <h4 id=configuration-loading>Configuration Loading<a class=headerlink href=#configuration-loading title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=k>def</span><span class=w> </span><span class=nf>load</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Config</span><span class=p>:</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>    <span class=n>default_config</span> <span class=o>=</span> <span class=n>Config</span><span class=p>()</span>  <span class=c1># Framework defaults</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>    <span class=n>global_config</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_yaml</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>global_config_path</span><span class=p>)</span>  <span class=c1># Global config</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>    <span class=n>project_config</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span>  <span class=c1># Project config</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>    <span class=c1># Merge with precedence: project &gt; global &gt; default</span>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a>    <span class=n>merged</span> <span class=o>=</span> <span class=n>deep_merge</span><span class=p>(</span><span class=n>default_config</span><span class=p>,</span> <span class=n>global_config</span><span class=p>)</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>    <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>deep_merge</span><span class=p>(</span><span class=n>merged</span><span class=p>,</span> <span class=n>project_config</span><span class=p>)</span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span>
</span></code></pre></div> <h4 id=configuration-merging>Configuration Merging<a class=headerlink href=#configuration-merging title="Permanent link">&para;</a></h4> <p>The <code>deep_merge()</code> function recursively merges configurations:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=k>def</span><span class=w> </span><span class=nf>deep_merge</span><span class=p>(</span><span class=n>c1</span><span class=p>:</span> <span class=n>Config</span><span class=p>,</span> <span class=n>c2</span><span class=p>:</span> <span class=n>Config</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Config</span><span class=p>:</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Merge c2 into c1, with c2 taking precedence.&quot;&quot;&quot;</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>    <span class=c1># Recursively merge dictionaries</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>    <span class=c1># c2 values override c1 values</span>
</span></code></pre></div> <p><strong>Merge Rules:</strong></p> <ul> <li>Dictionary values are merged recursively</li> <li>List values are replaced (not merged)</li> <li>Scalar values are replaced</li> <li><code>None</code> values don't override existing values</li> </ul> <h4 id=default-configuration>Default Configuration<a class=headerlink href=#default-configuration title="Permanent link">&para;</a></h4> <p>If no configuration is provided, defaults are set:</p> <p><strong>Driver Sources:</strong></p> <ul> <li>appium (enabled=False)</li> <li>selenium (enabled=False)</li> <li>ble (enabled=False)</li> </ul> <p><strong>Element Sources:</strong></p> <ul> <li>appium_find_element (enabled=False)</li> <li>appium_page_source (enabled=False)</li> <li>appium_screenshot (enabled=False)</li> <li>camera_screenshot (enabled=False)</li> <li>selenium_find_element (enabled=False)</li> <li>selenium_screenshot (enabled=False)</li> </ul> <p><strong>Text Detection:</strong></p> <ul> <li>easyocr (enabled=False)</li> <li>pytesseract (enabled=False)</li> <li>google_vision (enabled=False)</li> <li>remote_ocr (enabled=False)</li> </ul> <p><strong>Image Detection:</strong></p> <ul> <li>templatematch (enabled=False)</li> <li>remote_oir (enabled=False)</li> </ul> <h4 id=enabled-configuration-tracking>Enabled Configuration Tracking<a class=headerlink href=#enabled-configuration-tracking title="Permanent link">&para;</a></h4> <p>ConfigHandler precomputes enabled dependencies:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=k>def</span><span class=w> </span><span class=nf>_precompute_enabled_configs</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Precompute enabled configuration names for each dependency type.&quot;&quot;&quot;</span>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>    <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>DEPENDENCY_KEYS</span><span class=p>:</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>        <span class=n>dependencies</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_enabled_configs</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>            <span class=n>name</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>dependencies</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>            <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>details</span> <span class=ow>in</span> <span class=n>item</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>            <span class=k>if</span> <span class=n>details</span><span class=o>.</span><span class=n>enabled</span>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>        <span class=p>]</span>
</span></code></pre></div> <p>This allows efficient lookup of enabled dependencies without iterating through all configurations.</p> <h4 id=configuration-access>Configuration Access<a class=headerlink href=#configuration-access title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=c1># Get enabled dependencies</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=n>enabled_drivers</span> <span class=o>=</span> <span class=n>config_handler</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;driver_sources&quot;</span><span class=p>)</span>  <span class=c1># Returns list of enabled driver names</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=c1># Get specific dependency config</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=n>driver_config</span> <span class=o>=</span> <span class=n>config_handler</span><span class=o>.</span><span class=n>get_dependency_config</span><span class=p>(</span><span class=s2>&quot;driver_sources&quot;</span><span class=p>,</span> <span class=s2>&quot;appium&quot;</span><span class=p>)</span>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=c1># Returns: {&quot;url&quot;: &quot;...&quot;, &quot;capabilities&quot;: {...}}</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=c1># Get any config value</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a><span class=n>log_level</span> <span class=o>=</span> <span class=n>config_handler</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;log_level&quot;</span><span class=p>,</span> <span class=s2>&quot;INFO&quot;</span><span class=p>)</span>
</span></code></pre></div> <h4 id=configuration-validation>Configuration Validation<a class=headerlink href=#configuration-validation title="Permanent link">&para;</a></h4> <p>Configuration is validated using Pydantic:</p> <ul> <li>Type checking for all fields</li> <li>Required field validation</li> <li>Default value application</li> <li>Model validation on initialization</li> </ul> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=k>try</span><span class=p>:</span>
</span><span id=__span-35-2><a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>    <span class=n>config</span> <span class=o>=</span> <span class=n>Config</span><span class=p>(</span><span class=o>**</span><span class=n>config_dict</span><span class=p>)</span>
</span><span id=__span-35-3><a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=k>except</span> <span class=n>ValidationError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-35-4><a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>    <span class=k>raise</span> <span class=n>OpticsError</span><span class=p>(</span><span class=n>Code</span><span class=o>.</span><span class=n>E0503</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Configuration validation failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <h4 id=configuration-update>Configuration Update<a class=headerlink href=#configuration-update title="Permanent link">&para;</a></h4> <p>Configurations can be updated dynamically:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=n>config_handler</span><span class=o>.</span><span class=n>update_config</span><span class=p>({</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>    <span class=s2>&quot;log_level&quot;</span><span class=p>:</span> <span class=s2>&quot;DEBUG&quot;</span><span class=p>,</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a>    <span class=s2>&quot;driver_sources&quot;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&quot;appium&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>:</span> <span class=s2>&quot;...&quot;</span><span class=p>}}]</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=p>})</span>
</span></code></pre></div> <p>The update merges new values into existing configuration.</p> <h4 id=configuration-file-format>Configuration File Format<a class=headerlink href=#configuration-file-format title="Permanent link">&para;</a></h4> <p><strong>YAML Format:</strong> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=nt>driver_sources</span><span class=p>:</span>
</span><span id=__span-37-2><a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>appium</span><span class=p>:</span>
</span><span id=__span-37-3><a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-37-4><a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>&quot;http://localhost:4723&quot;</span>
</span><span id=__span-37-5><a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=w>      </span><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-37-6><a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=w>        </span><span class=nt>platformName</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Android&quot;</span>
</span><span id=__span-37-7><a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=w>        </span><span class=nt>deviceName</span><span class=p>:</span><span class=w> </span><span class=s>&quot;emulator-5554&quot;</span>
</span><span id=__span-37-8><a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>
</span><span id=__span-37-9><a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a><span class=nt>elements_sources</span><span class=p>:</span>
</span><span id=__span-37-10><a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>appium_find_element</span><span class=p>:</span>
</span><span id=__span-37-11><a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-37-12><a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>
</span><span id=__span-37-13><a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a><span class=nt>text_detection</span><span class=p>:</span>
</span><span id=__span-37-14><a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>easyocr</span><span class=p>:</span>
</span><span id=__span-37-15><a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-37-16><a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a><span class=w>      </span><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-37-17><a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a><span class=w>        </span><span class=nt>languages</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;en&quot;</span><span class="p p-Indicator">]</span>
</span><span id=__span-37-18><a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a>
</span><span id=__span-37-19><a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a><span class=nt>project_path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/path/to/project&quot;</span>
</span><span id=__span-37-20><a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a><span class=nt>execution_output_path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/path/to/output&quot;</span>
</span><span id=__span-37-21><a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a><span class=nt>log_level</span><span class=p>:</span><span class=w> </span><span class=s>&quot;INFO&quot;</span>
</span></code></pre></div></p> <h4 id=configuration-examples>Configuration Examples<a class=headerlink href=#configuration-examples title="Permanent link">&para;</a></h4> <p><strong>Minimal Configuration:</strong> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=nt>driver_sources</span><span class=p>:</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>appium</span><span class=p>:</span>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>&quot;http://localhost:4723&quot;</span>
</span></code></pre></div></p> <p><strong>Full Configuration:</strong> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=nt>driver_sources</span><span class=p>:</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>appium</span><span class=p>:</span>
</span><span id=__span-39-3><a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-39-4><a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>&quot;http://localhost:4723&quot;</span>
</span><span id=__span-39-5><a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=w>      </span><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-39-6><a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=w>        </span><span class=nt>platformName</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Android&quot;</span>
</span><span id=__span-39-7><a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=w>        </span><span class=nt>appPackage</span><span class=p>:</span><span class=w> </span><span class=s>&quot;com.example.app&quot;</span>
</span><span id=__span-39-8><a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>selenium</span><span class=p>:</span>
</span><span id=__span-39-9><a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id=__span-39-10><a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a>
</span><span id=__span-39-11><a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a><span class=nt>elements_sources</span><span class=p>:</span>
</span><span id=__span-39-12><a id=__codelineno-39-12 name=__codelineno-39-12 href=#__codelineno-39-12></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>appium_find_element</span><span class=p>:</span>
</span><span id=__span-39-13><a id=__codelineno-39-13 name=__codelineno-39-13 href=#__codelineno-39-13></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-39-14><a id=__codelineno-39-14 name=__codelineno-39-14 href=#__codelineno-39-14></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>appium_screenshot</span><span class=p>:</span>
</span><span id=__span-39-15><a id=__codelineno-39-15 name=__codelineno-39-15 href=#__codelineno-39-15></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-39-16><a id=__codelineno-39-16 name=__codelineno-39-16 href=#__codelineno-39-16></a>
</span><span id=__span-39-17><a id=__codelineno-39-17 name=__codelineno-39-17 href=#__codelineno-39-17></a><span class=nt>text_detection</span><span class=p>:</span>
</span><span id=__span-39-18><a id=__codelineno-39-18 name=__codelineno-39-18 href=#__codelineno-39-18></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>easyocr</span><span class=p>:</span>
</span><span id=__span-39-19><a id=__codelineno-39-19 name=__codelineno-39-19 href=#__codelineno-39-19></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-39-20><a id=__codelineno-39-20 name=__codelineno-39-20 href=#__codelineno-39-20></a><span class=w>      </span><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-39-21><a id=__codelineno-39-21 name=__codelineno-39-21 href=#__codelineno-39-21></a><span class=w>        </span><span class=nt>languages</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;en&quot;</span><span class="p p-Indicator">]</span>
</span><span id=__span-39-22><a id=__codelineno-39-22 name=__codelineno-39-22 href=#__codelineno-39-22></a><span class=w>        </span><span class=nt>gpu</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-39-23><a id=__codelineno-39-23 name=__codelineno-39-23 href=#__codelineno-39-23></a>
</span><span id=__span-39-24><a id=__codelineno-39-24 name=__codelineno-39-24 href=#__codelineno-39-24></a><span class=nt>image_detection</span><span class=p>:</span>
</span><span id=__span-39-25><a id=__codelineno-39-25 name=__codelineno-39-25 href=#__codelineno-39-25></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>templatematch</span><span class=p>:</span>
</span><span id=__span-39-26><a id=__codelineno-39-26 name=__codelineno-39-26 href=#__codelineno-39-26></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-39-27><a id=__codelineno-39-27 name=__codelineno-39-27 href=#__codelineno-39-27></a>
</span><span id=__span-39-28><a id=__codelineno-39-28 name=__codelineno-39-28 href=#__codelineno-39-28></a><span class=nt>project_path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/path/to/project&quot;</span>
</span><span id=__span-39-29><a id=__codelineno-39-29 name=__codelineno-39-29 href=#__codelineno-39-29></a><span class=nt>execution_output_path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/path/to/output&quot;</span>
</span><span id=__span-39-30><a id=__codelineno-39-30 name=__codelineno-39-30 href=#__codelineno-39-30></a><span class=nt>log_level</span><span class=p>:</span><span class=w> </span><span class=s>&quot;DEBUG&quot;</span>
</span><span id=__span-39-31><a id=__codelineno-39-31 name=__codelineno-39-31 href=#__codelineno-39-31></a><span class=nt>file_log</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-39-32><a id=__codelineno-39-32 name=__codelineno-39-32 href=#__codelineno-39-32></a><span class=nt>log_path</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/path/to/logs&quot;</span>
</span><span id=__span-39-33><a id=__codelineno-39-33 name=__codelineno-39-33 href=#__codelineno-39-33></a><span class=nt>event_attributes_json</span><span class=p>:</span><span class=w> </span><span class=s>&quot;/path/to/events.json&quot;</span>
</span><span id=__span-39-34><a id=__codelineno-39-34 name=__codelineno-39-34 href=#__codelineno-39-34></a><span class=nt>max_attempts</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id=__span-39-35><a id=__codelineno-39-35 name=__codelineno-39-35 href=#__codelineno-39-35></a><span class=nt>halt_duration</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
</span></code></pre></div></p> <h4 id=environment-specific-configuration>Environment-Specific Configuration<a class=headerlink href=#environment-specific-configuration title="Permanent link">&para;</a></h4> <p>Use global config for environment-specific settings:</p> <p><strong>Global Config (<code>~/.optics/global_config.yaml</code>):</strong> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=c1># Development environment</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=nt>log_level</span><span class=p>:</span><span class=w> </span><span class=s>&quot;DEBUG&quot;</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=nt>file_log</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-40-4><a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a>
</span><span id=__span-40-5><a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=c1># Production environment</span>
</span><span id=__span-40-6><a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=c1># log_level: &quot;INFO&quot;</span>
</span><span id=__span-40-7><a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=c1># file_log: false</span>
</span></code></pre></div></p> <p><strong>Project Config:</strong> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=c1># Project-specific settings</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=nt>driver_sources</span><span class=p>:</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>appium</span><span class=p>:</span>
</span><span id=__span-41-4><a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-41-5><a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>&quot;http://localhost:4723&quot;</span>
</span></code></pre></div></p> <h4 id=configuration-precedence-examples>Configuration Precedence Examples<a class=headerlink href=#configuration-precedence-examples title="Permanent link">&para;</a></h4> <p><strong>Example 1: Log Level</strong></p> <ul> <li>Default: <code>INFO</code></li> <li>Global: <code>DEBUG</code></li> <li>Project: <code>WARNING</code></li> <li><strong>Result:</strong> <code>WARNING</code> (project overrides)</li> </ul> <p><strong>Example 2: Driver URL</strong></p> <ul> <li>Default: <code>None</code></li> <li>Global: <code>http://localhost:4723</code></li> <li>Project: <code>http://remote:4723</code></li> <li><strong>Result:</strong> <code>http://remote:4723</code> (project overrides)</li> </ul> <p><strong>Example 3: Capabilities Merge</strong></p> <ul> <li>Default: <code>{}</code></li> <li>Global: <code>{platformName: "Android"}</code></li> <li>Project: <code>{deviceName: "emulator"}</code></li> <li><strong>Result:</strong> <code>{platformName: "Android", deviceName: "emulator"}</code> (merged)</li> </ul> <h4 id=configuration-validation-rules>Configuration Validation Rules<a class=headerlink href=#configuration-validation-rules title="Permanent link">&para;</a></h4> <ol> <li><strong>Required Fields</strong>: None (all fields have defaults)</li> <li><strong>Type Validation</strong>: All fields validated by Pydantic</li> <li><strong>Dependency Validation</strong>: Enabled dependencies must have valid configuration</li> <li><strong>Path Validation</strong>: Paths are validated on access (not on load)</li> </ol> <h4 id=best-practices_2>Best Practices<a class=headerlink href=#best-practices_2 title="Permanent link">&para;</a></h4> <ol> <li><strong>Use Global Config for Environment Settings</strong>: Store environment-specific settings in global config</li> <li><strong>Use Project Config for Project Settings</strong>: Store project-specific settings in project config</li> <li><strong>Enable Only Needed Dependencies</strong>: Disable unused dependencies for better performance</li> <li><strong>Use Capabilities for Driver Settings</strong>: Store driver-specific settings in capabilities</li> <li><strong>Validate Configuration Early</strong>: Check configuration during initialization</li> </ol> <h4 id=troubleshooting_1>Troubleshooting<a class=headerlink href=#troubleshooting_1 title="Permanent link">&para;</a></h4> <p><strong>Configuration Not Loading:</strong></p> <ul> <li>Check file path is correct</li> <li>Verify YAML syntax is valid</li> <li>Check file permissions</li> </ul> <p><strong>Dependencies Not Enabled:</strong></p> <ul> <li>Verify <code>enabled: true</code> in configuration</li> <li>Check dependency name is correct</li> <li>Review enabled configs: <code>config_handler.get("driver_sources")</code></li> </ul> <p><strong>Configuration Not Applied:</strong></p> <ul> <li>Check precedence order (project &gt; global &gt; default)</li> <li>Verify configuration was saved</li> <li>Check for merge conflicts</li> </ul> <h2 id=factory-system>Factory System<a class=headerlink href=#factory-system title="Permanent link">&para;</a></h2> <h3 id=genericfactory>GenericFactory<a class=headerlink href=#genericfactory title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/base_factory.py</code></p> <p>Base factory class that provides dynamic module discovery and instantiation capabilities with automatic registration, caching, and fallback support.</p> <h4 id=key-features>Key Features<a class=headerlink href=#key-features title="Permanent link">&para;</a></h4> <ul> <li>Automatic module discovery within packages</li> <li>Dynamic class loading and instantiation</li> <li>Interface-based implementation detection</li> <li>Instance caching for performance</li> <li>Support for extra dependencies (e.g., driver injection)</li> <li>Lazy module loading</li> <li>Fallback instance management</li> </ul> <h4 id=module-discovery-algorithm>Module Discovery Algorithm<a class=headerlink href=#module-discovery-algorithm title="Permanent link">&para;</a></h4> <p>The factory uses a recursive discovery algorithm:</p> <pre class=mermaid><code>graph TB
    A[register_package] --&gt; B[Load Package]
    B --&gt; C[Iterate Modules]
    C --&gt; D{Is Package?}
    D --&gt;|Yes| E[Recurse into Package]
    D --&gt;|No| F[Register Module]
    E --&gt; C
    F --&gt; G[Store Module Path]
    G --&gt; C</code></pre> <p><strong>Discovery Process:</strong></p> <ol> <li><strong>Package Loading</strong>: Load the package using <code>importlib.import_module()</code></li> <li><strong>Module Iteration</strong>: Use <code>pkgutil.iter_modules()</code> to iterate through modules</li> <li><strong>Recursive Discovery</strong>: For subpackages, recursively discover modules</li> <li><strong>Path Registration</strong>: Store module paths in registry for later use</li> </ol> <div class="language-python highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=nd>@classmethod</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=k>def</span><span class=w> </span><span class=nf>register_package</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>package</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Registers all modules within the specified package.&quot;&quot;&quot;</span>
</span><span id=__span-42-4><a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a>    <span class=n>package_obj</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_load_package</span><span class=p>(</span><span class=n>package</span><span class=p>)</span>
</span><span id=__span-42-5><a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a>    <span class=k>if</span> <span class=n>package_obj</span><span class=p>:</span>
</span><span id=__span-42-6><a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>_register_submodules</span><span class=p>(</span><span class=n>package_obj</span><span class=o>.</span><span class=n>__path__</span><span class=p>,</span> <span class=n>package</span><span class=p>)</span>
</span><span id=__span-42-7><a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a>
</span><span id=__span-42-8><a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=nd>@classmethod</span>
</span><span id=__span-42-9><a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a><span class=k>def</span><span class=w> </span><span class=nf>_register_submodules</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>package_paths</span><span class=p>,</span> <span class=n>base_package</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-42-10><a id=__codelineno-42-10 name=__codelineno-42-10 href=#__codelineno-42-10></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Recursively registers all submodules in a package.&quot;&quot;&quot;</span>
</span><span id=__span-42-11><a id=__codelineno-42-11 name=__codelineno-42-11 href=#__codelineno-42-11></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>module_name</span><span class=p>,</span> <span class=n>is_pkg</span> <span class=ow>in</span> <span class=n>pkgutil</span><span class=o>.</span><span class=n>iter_modules</span><span class=p>(</span><span class=n>package_paths</span><span class=p>):</span>
</span><span id=__span-42-12><a id=__codelineno-42-12 name=__codelineno-42-12 href=#__codelineno-42-12></a>        <span class=n>full_module_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>base_package</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>module_name</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-42-13><a id=__codelineno-42-13 name=__codelineno-42-13 href=#__codelineno-42-13></a>        <span class=bp>cls</span><span class=o>.</span><span class=n>_registry</span><span class=o>.</span><span class=n>module_paths</span><span class=p>[</span><span class=n>module_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>full_module_name</span>
</span><span id=__span-42-14><a id=__codelineno-42-14 name=__codelineno-42-14 href=#__codelineno-42-14></a>        <span class=k>if</span> <span class=n>is_pkg</span><span class=p>:</span>
</span><span id=__span-42-15><a id=__codelineno-42-15 name=__codelineno-42-15 href=#__codelineno-42-15></a>            <span class=bp>cls</span><span class=o>.</span><span class=n>_register_subpackage</span><span class=p>(</span><span class=n>full_module_name</span><span class=p>)</span>
</span></code></pre></div> <h4 id=module-registry>Module Registry<a class=headerlink href=#module-registry title="Permanent link">&para;</a></h4> <p>The factory maintains a registry of discovered modules:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=k>class</span><span class=w> </span><span class=nc>ModuleRegistry</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>,</span> <span class=n>Generic</span><span class=p>[</span><span class=n>S</span><span class=p>]):</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>    <span class=n>module_paths</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]</span>  <span class=c1># name -&gt; full_module_path</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a>    <span class=n>instances</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>S</span><span class=p>]</span>  <span class=c1># name -&gt; cached_instance</span>
</span></code></pre></div> <p><strong>Registry Structure:</strong> - <code>module_paths</code>: Maps module names to full import paths - <code>instances</code>: Caches instantiated objects for reuse</p> <h4 id=instance-creation>Instance Creation<a class=headerlink href=#instance-creation title="Permanent link">&para;</a></h4> <p>The factory provides multiple methods for instance creation:</p> <h5 id=dynamic-instance-creation>Dynamic Instance Creation<a class=headerlink href=#dynamic-instance-creation title="Permanent link">&para;</a></h5> <div class="language-python highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=nd>@classmethod</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=k>def</span><span class=w> </span><span class=nf>create_instance_dynamic</span><span class=p>(</span>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a>    <span class=bp>cls</span><span class=p>,</span>
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a>    <span class=n>config_dict</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span>
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a>    <span class=n>interface</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>T</span><span class=p>],</span>
</span><span id=__span-44-6><a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a>    <span class=n>package</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-44-7><a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a>    <span class=n>extra_kwargs</span><span class=p>:</span> <span class=nb>dict</span><span class=o>|</span><span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-44-8><a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>T</span><span class=p>:</span>
</span><span id=__span-44-9><a id=__codelineno-44-9 name=__codelineno-44-9 href=#__codelineno-44-9></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Unified instance creation supporting config and extra dependencies.&quot;&quot;&quot;</span>
</span></code></pre></div> <p><strong>Process:</strong></p> <ol> <li>Extract name and config from <code>config_dict</code></li> <li>Check if module is registered, load if not</li> <li>Import module dynamically</li> <li>Locate implementation class</li> <li>Inspect constructor signature</li> <li>Instantiate with config and extra kwargs</li> <li>Cache instance</li> </ol> <p><strong>Example:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=n>driver</span> <span class=o>=</span> <span class=n>DeviceFactory</span><span class=o>.</span><span class=n>create_instance_dynamic</span><span class=p>(</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>    <span class=p>{</span><span class=s2>&quot;appium&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>:</span> <span class=s2>&quot;...&quot;</span><span class=p>}},</span>
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a>    <span class=n>DriverInterface</span><span class=p>,</span>
</span><span id=__span-45-4><a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a>    <span class=s2>&quot;optics_framework.engines.drivers&quot;</span><span class=p>,</span>
</span><span id=__span-45-5><a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a>    <span class=n>extra_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;event_sdk&quot;</span><span class=p>:</span> <span class=n>event_sdk</span><span class=p>}</span>
</span><span id=__span-45-6><a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a><span class=p>)</span>
</span></code></pre></div></p> <h5 id=instance-creation-with-caching>Instance Creation with Caching<a class=headerlink href=#instance-creation-with-caching title="Permanent link">&para;</a></h5> <div class="language-python highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=nd>@classmethod</span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=k>def</span><span class=w> </span><span class=nf>_create_or_retrieve</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>config_dict</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>interface</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>T</span><span class=p>],</span> <span class=n>package</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>T</span><span class=p>:</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Creates a new instance or retrieves a cached one.&quot;&quot;&quot;</span>
</span></code></pre></div> <p><strong>Caching Strategy:</strong></p> <ul> <li>Check if instance exists in cache</li> <li>If cached, return existing instance</li> <li>If not cached, create new instance and cache it</li> <li>Cache key is the module name</li> </ul> <p><strong>Benefits:</strong></p> <ul> <li>Reduces instantiation overhead</li> <li>Ensures singleton behavior per module name</li> <li>Improves performance for repeated access</li> </ul> <h4 id=lazy-module-loading>Lazy Module Loading<a class=headerlink href=#lazy-module-loading title="Permanent link">&para;</a></h4> <p>Modules are loaded on-demand:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=nd>@classmethod</span>
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=k>def</span><span class=w> </span><span class=nf>_load_module</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>package</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Loads a specific module dynamically.&quot;&quot;&quot;</span>
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a>    <span class=n>full_module_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>package</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a>    <span class=n>importlib</span><span class=o>.</span><span class=n>import_module</span><span class=p>(</span><span class=n>full_module_name</span><span class=p>)</span>
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_registry</span><span class=o>.</span><span class=n>module_paths</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>full_module_name</span>
</span></code></pre></div> <p><strong>When Lazy Loading Occurs:</strong></p> <ul> <li>Module not found in registry during instantiation</li> <li>First access to a module</li> <li>Dynamic module discovery</li> </ul> <p><strong>Benefits:</strong></p> <ul> <li>Faster startup time</li> <li>Only loads modules that are actually used</li> <li>Reduces memory footprint</li> </ul> <h4 id=interface-based-detection>Interface-Based Detection<a class=headerlink href=#interface-based-detection title="Permanent link">&para;</a></h4> <p>The factory locates implementations by checking interface inheritance:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=nd>@staticmethod</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a><span class=k>def</span><span class=w> </span><span class=nf>_locate_implementation</span><span class=p>(</span><span class=n>module</span><span class=p>:</span> <span class=n>ModuleType</span><span class=p>,</span> <span class=n>interface</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>T</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Type</span><span class=p>[</span><span class=n>T</span><span class=p>]]:</span>
</span><span id=__span-48-3><a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Locates a class in the module that implements the given interface.&quot;&quot;&quot;</span>
</span><span id=__span-48-4><a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a>    <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>obj</span> <span class=ow>in</span> <span class=n>inspect</span><span class=o>.</span><span class=n>getmembers</span><span class=p>(</span><span class=n>module</span><span class=p>,</span> <span class=n>inspect</span><span class=o>.</span><span class=n>isclass</span><span class=p>):</span>
</span><span id=__span-48-5><a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a>        <span class=k>if</span> <span class=nb>issubclass</span><span class=p>(</span><span class=n>obj</span><span class=p>,</span> <span class=n>interface</span><span class=p>)</span> <span class=ow>and</span> <span class=n>obj</span> <span class=ow>is</span> <span class=ow>not</span> <span class=n>interface</span><span class=p>:</span>
</span><span id=__span-48-6><a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a>            <span class=k>return</span> <span class=n>obj</span>
</span><span id=__span-48-7><a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a>    <span class=k>return</span> <span class=kc>None</span>
</span></code></pre></div> <p><strong>Detection Rules:</strong></p> <ol> <li>Iterate through all classes in module</li> <li>Check if class is subclass of interface</li> <li>Exclude the interface itself</li> <li>Return first matching class</li> </ol> <h4 id=constructor-signature-inspection>Constructor Signature Inspection<a class=headerlink href=#constructor-signature-inspection title="Permanent link">&para;</a></h4> <p>The factory inspects constructor signatures to determine parameters:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=n>sig</span> <span class=o>=</span> <span class=n>inspect</span><span class=o>.</span><span class=n>signature</span><span class=p>(</span><span class=n>implementation</span><span class=o>.</span><span class=fm>__init__</span><span class=p>)</span>
</span><span id=__span-49-2><a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a><span class=n>kwargs</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-49-3><a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=k>if</span> <span class=s2>&quot;config&quot;</span> <span class=ow>in</span> <span class=n>sig</span><span class=o>.</span><span class=n>parameters</span><span class=p>:</span>
</span><span id=__span-49-4><a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a>    <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;config&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>config</span>
</span><span id=__span-49-5><a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a><span class=k>if</span> <span class=n>extra_kwargs</span><span class=p>:</span>
</span><span id=__span-49-6><a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a>    <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>extra_kwargs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-49-7><a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a>        <span class=k>if</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>sig</span><span class=o>.</span><span class=n>parameters</span><span class=p>:</span>
</span><span id=__span-49-8><a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a>            <span class=n>kwargs</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>v</span>
</span><span id=__span-49-9><a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a><span class=n>instance</span> <span class=o>=</span> <span class=n>implementation</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Parameter Injection:</strong></p> <ul> <li><code>config</code>: Injected if constructor accepts it</li> <li><code>extra_kwargs</code>: Injected if constructor accepts them</li> <li>Graceful fallback if config causes TypeError</li> </ul> <h4 id=fallback-instance-creation>Fallback Instance Creation<a class=headerlink href=#fallback-instance-creation title="Permanent link">&para;</a></h4> <p>When multiple configurations are provided, factory creates fallback instances:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-50-1><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=nd>@classmethod</span>
</span><span id=__span-50-2><a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a><span class=k>def</span><span class=w> </span><span class=nf>_create_fallback</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>dict</span><span class=p>],</span> <span class=n>interface</span><span class=p>:</span> <span class=n>Type</span><span class=p>[</span><span class=n>T</span><span class=p>],</span> <span class=n>package</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>T</span><span class=p>:</span>
</span><span id=__span-50-3><a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Creates a fallback instance from a list of config dicts.&quot;&quot;&quot;</span>
</span><span id=__span-50-4><a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a>    <span class=n>instances</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-50-5><a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a>    <span class=k>for</span> <span class=n>config_dict</span> <span class=ow>in</span> <span class=n>name</span><span class=p>:</span>
</span><span id=__span-50-6><a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a>        <span class=n>instances</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_create_or_retrieve</span><span class=p>(</span><span class=n>config_dict</span><span class=p>,</span> <span class=n>interface</span><span class=p>,</span> <span class=n>package</span><span class=p>))</span>
</span><span id=__span-50-7><a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a>    <span class=k>return</span> <span class=n>InstanceFallback</span><span class=p>(</span><span class=n>instances</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Fallback Flow:</strong></p> <ol> <li>Create instance for each configuration</li> <li>Wrap instances in <code>InstanceFallback</code></li> <li>Fallback tries each instance until one succeeds</li> </ol> <h4 id=instancefallback>InstanceFallback<a class=headerlink href=#instancefallback title="Permanent link">&para;</a></h4> <p>Manages multiple instances with automatic fallback:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-51-1><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=k>class</span><span class=w> </span><span class=nc>InstanceFallback</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>,</span> <span class=n>Generic</span><span class=p>[</span><span class=n>T</span><span class=p>]):</span>
</span><span id=__span-51-2><a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>    <span class=n>instances</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>T</span><span class=p>]</span>
</span><span id=__span-51-3><a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a>    <span class=n>current_instance</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>T</span><span class=p>]</span>
</span></code></pre></div> <p><strong>Fallback Mechanism:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-52-1><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=k>def</span><span class=w> </span><span class=fm>__getattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>attr</span><span class=p>):</span>
</span><span id=__span-52-2><a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>    <span class=k>def</span><span class=w> </span><span class=nf>fallback_method</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span><span id=__span-52-3><a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a>        <span class=k>for</span> <span class=n>instance</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>instances</span><span class=p>:</span>
</span><span id=__span-52-4><a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-52-5><a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a>                <span class=n>method</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>
</span><span id=__span-52-6><a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a>                <span class=k>return</span> <span class=n>method</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-52-7><a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-52-8><a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a>                <span class=k>continue</span>  <span class=c1># Try next instance</span>
</span><span id=__span-52-9><a id=__codelineno-52-9 name=__codelineno-52-9 href=#__codelineno-52-9></a>        <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>(</span><span class=s2>&quot;All instances failed&quot;</span><span class=p>)</span>
</span><span id=__span-52-10><a id=__codelineno-52-10 name=__codelineno-52-10 href=#__codelineno-52-10></a>    <span class=k>return</span> <span class=n>fallback_method</span>
</span></code></pre></div></p> <p><strong>Usage:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-53-1><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=c1># If Appium fails, automatically tries Selenium</span>
</span><span id=__span-53-2><a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a><span class=n>fallback_driver</span><span class=o>.</span><span class=n>press_element</span><span class=p>(</span><span class=n>element</span><span class=p>)</span>
</span></code></pre></div></p> <h4 id=factory-registration-timing>Factory Registration Timing<a class=headerlink href=#factory-registration-timing title="Permanent link">&para;</a></h4> <p>Factories register packages at different times:</p> <p><strong>DeviceFactory:</strong></p> <ul> <li>Registers <code>optics_framework.engines.drivers</code> on first use</li> </ul> <p><strong>ElementSourceFactory:</strong></p> <ul> <li>Registers <code>optics_framework.engines.elementsources</code> on first use</li> </ul> <p><strong>ImageFactory:</strong></p> <ul> <li>Registers <code>optics_framework.engines.vision_models.image_models</code> on first use</li> </ul> <p><strong>TextFactory:</strong></p> <ul> <li>Registers <code>optics_framework.engines.vision_models.ocr_models</code> on first use</li> </ul> <h4 id=error-handling>Error Handling<a class=headerlink href=#error-handling title="Permanent link">&para;</a></h4> <p>The factory handles various error scenarios:</p> <p><strong>Module Not Found:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-54-1><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=k>except</span> <span class=ne>KeyError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
</span><span id=__span-54-2><a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a>    <span class=k>raise</span> <span class=n>OpticsError</span><span class=p>(</span><span class=n>Code</span><span class=o>.</span><span class=n>E0601</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Unknown module: &#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39;&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>No Implementation Found:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-55-1><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=k>if</span> <span class=ow>not</span> <span class=n>implementation</span><span class=p>:</span>
</span><span id=__span-55-2><a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a>    <span class=k>raise</span> <span class=n>OpticsError</span><span class=p>(</span><span class=n>Code</span><span class=o>.</span><span class=n>E0603</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;No implementation found&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <p><strong>Import Errors:</strong> <div class="language-python highlight"><pre><span></span><code><span id=__span-56-1><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=k>except</span> <span class=ne>ModuleNotFoundError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-56-2><a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>    <span class=k>raise</span> <span class=n>OpticsError</span><span class=p>(</span><span class=n>Code</span><span class=o>.</span><span class=n>X0604</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&quot;Import error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></p> <h4 id=performance-considerations_1>Performance Considerations<a class=headerlink href=#performance-considerations_1 title="Permanent link">&para;</a></h4> <ol> <li><strong>Instance Caching</strong>: Reduces instantiation overhead</li> <li><strong>Lazy Loading</strong>: Only loads modules when needed</li> <li><strong>Registry Lookup</strong>: Fast O(1) module path lookup</li> <li><strong>Signature Caching</strong>: Pydantic caches signature inspection</li> </ol> <h4 id=cache-management>Cache Management<a class=headerlink href=#cache-management title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-57-1><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=nd>@classmethod</span>
</span><span id=__span-57-2><a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a><span class=k>def</span><span class=w> </span><span class=nf>clear_instances</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-57-3><a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Clears all cached instances.&quot;&quot;&quot;</span>
</span><span id=__span-57-4><a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a>    <span class=bp>cls</span><span class=o>.</span><span class=n>_registry</span><span class=o>.</span><span class=n>instances</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></code></pre></div> <p><strong>When to Clear:</strong></p> <ul> <li>Between test runs</li> <li>When configuration changes</li> <li>During cleanup</li> </ul> <h4 id=factory-lifecycle>Factory Lifecycle<a class=headerlink href=#factory-lifecycle title="Permanent link">&para;</a></h4> <pre class=mermaid><code>sequenceDiagram
    participant Factory
    participant Registry
    participant Module
    participant Instance

    Factory-&gt;&gt;Registry: Check if registered
    alt Not Registered
        Factory-&gt;&gt;Module: Discover modules
        Module--&gt;&gt;Factory: Module paths
        Factory-&gt;&gt;Registry: Register paths
    end
    Factory-&gt;&gt;Registry: Check cache
    alt Not Cached
        Factory-&gt;&gt;Module: Import module
        Factory-&gt;&gt;Module: Locate implementation
        Factory-&gt;&gt;Instance: Create instance
        Factory-&gt;&gt;Registry: Cache instance
    end
    Registry--&gt;&gt;Factory: Return instance</code></pre> <h4 id=best-practices_3>Best Practices<a class=headerlink href=#best-practices_3 title="Permanent link">&para;</a></h4> <ol> <li><strong>Register Packages Early</strong>: Register packages during initialization</li> <li><strong>Use Caching</strong>: Leverage instance caching for performance</li> <li><strong>Handle Errors</strong>: Always handle factory errors gracefully</li> <li><strong>Clear Cache When Needed</strong>: Clear cache between test runs</li> <li><strong>Use Fallback</strong>: Configure multiple instances for resilience</li> </ol> <h4 id=troubleshooting_2>Troubleshooting<a class=headerlink href=#troubleshooting_2 title="Permanent link">&para;</a></h4> <p><strong>Module Not Found:</strong></p> <ul> <li>Verify module is in correct package directory</li> <li>Check module name matches file name</li> <li>Ensure module implements correct interface</li> </ul> <p><strong>No Implementation Found:</strong></p> <ul> <li>Verify class extends interface</li> <li>Check class is not the interface itself</li> <li>Ensure class is imported in module</li> </ul> <p><strong>Import Errors:</strong></p> <ul> <li>Check module dependencies are installed</li> <li>Verify import paths are correct</li> <li>Review module initialization code</li> </ul> <h3 id=devicefactory>DeviceFactory<a class=headerlink href=#devicefactory title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/factories.py</code></p> <p>Factory for creating driver instances.</p> <h4 id=default-package>Default Package<a class=headerlink href=#default-package title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-58-1><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=n>DEFAULT_PACKAGE</span> <span class=o>=</span> <span class=s2>&quot;optics_framework.engines.drivers&quot;</span>
</span></code></pre></div> <h4 id=usage>Usage<a class=headerlink href=#usage title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-59-1><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=n>driver</span> <span class=o>=</span> <span class=n>DeviceFactory</span><span class=o>.</span><span class=n>get_driver</span><span class=p>(</span>
</span><span id=__span-59-2><a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a>    <span class=p>[{</span><span class=s2>&quot;appium&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>:</span> <span class=s2>&quot;...&quot;</span><span class=p>,</span> <span class=s2>&quot;capabilities&quot;</span><span class=p>:</span> <span class=p>{</span><span class=o>...</span><span class=p>}}}],</span>
</span><span id=__span-59-3><a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a>    <span class=n>event_sdk</span><span class=o>=</span><span class=n>event_sdk</span>
</span><span id=__span-59-4><a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a><span class=p>)</span>
</span></code></pre></div> <h3 id=elementsourcefactory>ElementSourceFactory<a class=headerlink href=#elementsourcefactory title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/factories.py</code></p> <p>Factory for creating element source instances with automatic driver matching.</p> <h4 id=key-features_1>Key Features<a class=headerlink href=#key-features_1 title="Permanent link">&para;</a></h4> <ul> <li>Automatically matches element sources with compatible drivers</li> <li>Uses <code>REQUIRED_DRIVER_TYPE</code> attribute for matching</li> <li>Injects matched driver into element source constructor</li> </ul> <h4 id=driver-matching-logic>Driver Matching Logic<a class=headerlink href=#driver-matching-logic title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-60-1><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=nd>@classmethod</span>
</span><span id=__span-60-2><a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a><span class=k>def</span><span class=w> </span><span class=nf>_find_matching_driver</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>implementation</span><span class=p>,</span> <span class=n>driver_instances</span><span class=p>):</span>
</span><span id=__span-60-3><a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Find a driver instance that matches the required driver type.&quot;&quot;&quot;</span>
</span><span id=__span-60-4><a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a>    <span class=n>required_type</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>implementation</span><span class=p>,</span> <span class=s2>&quot;REQUIRED_DRIVER_TYPE&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-60-5><a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a>    <span class=c1># Matches by NAME attribute</span>
</span></code></pre></div> <h3 id=imagefactory-and-textfactory>ImageFactory and TextFactory<a class=headerlink href=#imagefactory-and-textfactory title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/factories.py</code></p> <p>Factories for vision model instantiation.</p> <ul> <li><strong>ImageFactory</strong>: <code>optics_framework.engines.vision_models.image_models</code></li> <li><strong>TextFactory</strong>: <code>optics_framework.engines.vision_models.ocr_models</code></li> </ul> <h3 id=instancefallback_1>InstanceFallback<a class=headerlink href=#instancefallback_1 title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/base_factory.py</code></p> <p>Wraps multiple implementations and provides automatic fallback when methods fail.</p> <h4 id=fallback-mechanism>Fallback Mechanism<a class=headerlink href=#fallback-mechanism title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-61-1><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=k>class</span><span class=w> </span><span class=nc>InstanceFallback</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>,</span> <span class=n>Generic</span><span class=p>[</span><span class=n>T</span><span class=p>]):</span>
</span><span id=__span-61-2><a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a>    <span class=n>instances</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>T</span><span class=p>]</span>
</span><span id=__span-61-3><a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a>    <span class=n>current_instance</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>T</span><span class=p>]</span>
</span><span id=__span-61-4><a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a>
</span><span id=__span-61-5><a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__getattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>attr</span><span class=p>):</span>
</span><span id=__span-61-6><a id=__codelineno-61-6 name=__codelineno-61-6 href=#__codelineno-61-6></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Tries each instance until one succeeds.&quot;&quot;&quot;</span>
</span><span id=__span-61-7><a id=__codelineno-61-7 name=__codelineno-61-7 href=#__codelineno-61-7></a>        <span class=k>for</span> <span class=n>instance</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>instances</span><span class=p>:</span>
</span><span id=__span-61-8><a id=__codelineno-61-8 name=__codelineno-61-8 href=#__codelineno-61-8></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-61-9><a id=__codelineno-61-9 name=__codelineno-61-9 href=#__codelineno-61-9></a>                <span class=k>return</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>attr</span><span class=p>)(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span><span id=__span-61-10><a id=__codelineno-61-10 name=__codelineno-61-10 href=#__codelineno-61-10></a>            <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span><span id=__span-61-11><a id=__codelineno-61-11 name=__codelineno-61-11 href=#__codelineno-61-11></a>                <span class=k>continue</span>
</span><span id=__span-61-12><a id=__codelineno-61-12 name=__codelineno-61-12 href=#__codelineno-61-12></a>        <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>(</span><span class=s2>&quot;All instances failed&quot;</span><span class=p>)</span>
</span></code></pre></div> <h4 id=usage-pattern>Usage Pattern<a class=headerlink href=#usage-pattern title="Permanent link">&para;</a></h4> <p>When multiple drivers are configured, they're wrapped in <code>InstanceFallback</code>: <div class="language-python highlight"><pre><span></span><code><span id=__span-62-1><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=c1># If Appium fails, automatically tries Selenium</span>
</span><span id=__span-62-2><a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a><span class=n>fallback_driver</span><span class=o>.</span><span class=n>press_element</span><span class=p>(</span><span class=n>element</span><span class=p>)</span>
</span></code></pre></div></p> <h2 id=interfaces>Interfaces<a class=headerlink href=#interfaces title="Permanent link">&para;</a></h2> <h3 id=driverinterface>DriverInterface<a class=headerlink href=#driverinterface title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/driver_interface.py</code></p> <p>Abstract interface for action drivers that execute user actions.</p> <h4 id=key-methods_2>Key Methods<a class=headerlink href=#key-methods_2 title="Permanent link">&para;</a></h4> <ul> <li><code>launch_app()</code> - Launch applications</li> <li><code>press_coordinates()</code> - Press at absolute coordinates</li> <li><code>press_element()</code> - Press UI elements</li> <li><code>enter_text()</code> - Text input</li> <li><code>swipe()</code> / <code>scroll()</code> - Gesture actions</li> <li><code>get_text_element()</code> - Extract text</li> <li><code>terminate()</code> - Cleanup</li> </ul> <h4 id=implementations>Implementations<a class=headerlink href=#implementations title="Permanent link">&para;</a></h4> <ul> <li><code>AppiumDriver</code> - Mobile app automation</li> <li><code>SeleniumDriver</code> - Web browser automation</li> <li><code>PlaywrightDriver</code> - Modern web automation</li> <li><code>BLEDriver</code> - Non-intrusive BLE mouse/keyboard</li> </ul> <h3 id=elementsourceinterface>ElementSourceInterface<a class=headerlink href=#elementsourceinterface title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/elementsource_interface.py</code></p> <p>Abstract interface for element detection and screen capture.</p> <h4 id=key-methods_3>Key Methods<a class=headerlink href=#key-methods_3 title="Permanent link">&para;</a></h4> <ul> <li><code>capture()</code> - Capture current screen state</li> <li><code>locate()</code> - Locate elements (XPath, text, etc.)</li> <li><code>assert_elements()</code> - Verify element presence</li> <li><code>get_interactive_elements()</code> - Get clickable elements</li> </ul> <h4 id=implementations_1>Implementations<a class=headerlink href=#implementations_1 title="Permanent link">&para;</a></h4> <ul> <li><code>AppiumFindElement</code> - Appium-based element location</li> <li><code>SeleniumFindElement</code> - Selenium-based element location</li> <li><code>PlaywrightFindElement</code> - Playwright-based element location</li> <li><code>AppiumScreenshot</code> / <code>SeleniumScreenshot</code> / <code>PlaywrightScreenshot</code> - Screenshot capture</li> <li><code>CameraScreenshot</code> - External camera capture</li> <li><code>AppiumPageSource</code> / <code>SeleniumPageSource</code> / <code>PlaywrightPageSource</code> - Page source extraction</li> </ul> <h3 id=imageinterface>ImageInterface<a class=headerlink href=#imageinterface title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/image_interface.py</code></p> <p>Abstract interface for image template matching.</p> <h4 id=key-methods_4>Key Methods<a class=headerlink href=#key-methods_4 title="Permanent link">&para;</a></h4> <ul> <li><code>element_exist()</code> - Check if image exists in frame</li> <li><code>find_element()</code> - Locate image with detailed info</li> <li><code>assert_elements()</code> - Verify multiple images</li> </ul> <h4 id=implementations_2>Implementations<a class=headerlink href=#implementations_2 title="Permanent link">&para;</a></h4> <ul> <li><code>TemplateMatch</code> - OpenCV template matching</li> <li><code>RemoteOIR</code> - Remote object image recognition service</li> </ul> <h3 id=textinterface>TextInterface<a class=headerlink href=#textinterface title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/common/text_interface.py</code></p> <p>Abstract interface for OCR and text detection.</p> <h4 id=key-methods_5>Key Methods<a class=headerlink href=#key-methods_5 title="Permanent link">&para;</a></h4> <ul> <li><code>element_exist()</code> - Check if text exists</li> <li><code>find_element()</code> - Locate text with bounding box</li> <li><code>detect_text()</code> - Full text detection with confidence</li> </ul> <h4 id=implementations_3>Implementations<a class=headerlink href=#implementations_3 title="Permanent link">&para;</a></h4> <ul> <li><code>EasyOCR</code> - EasyOCR library</li> <li><code>GoogleVision</code> - Google Cloud Vision API</li> <li><code>PyTesseract</code> - Tesseract OCR</li> <li><code>RemoteOCR</code> - Remote OCR service</li> </ul> <h2 id=api-modules>API Modules<a class=headerlink href=#api-modules title="Permanent link">&para;</a></h2> <h3 id=actionkeyword>ActionKeyword<a class=headerlink href=#actionkeyword title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/api/action_keyword.py</code></p> <p>High-level API for executing user actions with self-healing.</p> <h4 id=key-features_2>Key Features<a class=headerlink href=#key-features_2 title="Permanent link">&para;</a></h4> <ul> <li>Self-healing through <code>@with_self_healing</code> decorator</li> <li>Automatic strategy selection</li> <li>Area of Interest (AOI) support</li> <li>Screenshot capture on actions</li> </ul> <h4 id=self-healing-decorator>Self-Healing Decorator<a class=headerlink href=#self-healing-decorator title="Permanent link">&para;</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-63-1><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=nd>@with_self_healing</span>
</span><span id=__span-63-2><a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a><span class=k>def</span><span class=w> </span><span class=nf>press_element</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>element</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>located</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span><span id=__span-63-3><a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Automatically tries multiple strategies until one succeeds.&quot;&quot;&quot;</span>
</span></code></pre></div> <h4 id=key-methods_6>Key Methods<a class=headerlink href=#key-methods_6 title="Permanent link">&para;</a></h4> <ul> <li><code>press_element()</code> - Press with AOI support</li> <li><code>press_by_coordinates()</code> - Absolute coordinates</li> <li><code>press_by_percentage()</code> - Percentage coordinates</li> <li><code>swipe()</code> / <code>scroll()</code> - Gestures</li> <li><code>enter_text()</code> - Text input</li> <li><code>press_keycode()</code> - Hardware keys</li> </ul> <h3 id=appmanagement>AppManagement<a class=headerlink href=#appmanagement title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/api/app_management.py</code></p> <p>Manages application lifecycle.</p> <h4 id=key-methods_7>Key Methods<a class=headerlink href=#key-methods_7 title="Permanent link">&para;</a></h4> <ul> <li><code>launch_app()</code> - Launch with identifier/activity</li> <li><code>launch_other_app()</code> - Launch different app</li> <li><code>start_appium_session()</code> - Start Appium session</li> <li><code>close_and_terminate_app()</code> - Cleanup</li> <li><code>force_terminate_app()</code> - Force kill</li> <li><code>get_app_version()</code> - Version info</li> </ul> <h3 id=verifier>Verifier<a class=headerlink href=#verifier title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/api/verifier.py</code></p> <p>Provides assertion and validation capabilities.</p> <h4 id=key-methods_8>Key Methods<a class=headerlink href=#key-methods_8 title="Permanent link">&para;</a></h4> <ul> <li><code>validate_element()</code> - Verify single element</li> <li><code>validate_screen()</code> - Verify multiple elements</li> <li><code>assert_presence()</code> - Assert with rules (any/all)</li> <li><code>assert_images_vision()</code> - Vision-based image assertion</li> <li><code>assert_texts_vision()</code> - Vision-based text assertion</li> <li><code>get_interactive_elements()</code> - Get UI elements</li> <li><code>capture_screenshot()</code> - Screenshot capture</li> <li><code>capture_pagesource()</code> - Page source capture</li> </ul> <h3 id=flowcontrol>FlowControl<a class=headerlink href=#flowcontrol title="Permanent link">&para;</a></h3> <p><strong>Location:</strong> <code>optics_framework/api/flow_control.py</code></p> <p>Manages control flow and data operations.</p> <h4 id=key-methods_9>Key Methods<a class=headerlink href=#key-methods_9 title="Permanent link">&para;</a></h4> <ul> <li><code>condition()</code> - Conditional execution</li> <li><code>evaluate()</code> - Expression evaluation</li> <li><code>read_data()</code> - Read from CSV/API/list</li> <li><code>run_loop()</code> - Loop execution</li> <li><code>invoke_api()</code> - REST API calls</li> <li><code>date_evaluate()</code> - Date calculations</li> </ul> <h2 id=component-interactions>Component Interactions<a class=headerlink href=#component-interactions title="Permanent link">&para;</a></h2> <h3 id=initialization-flow>Initialization Flow<a class=headerlink href=#initialization-flow title="Permanent link">&para;</a></h3> <pre class=mermaid><code>sequenceDiagram
    participant User
    participant Optics
    participant SessionMgr
    participant Session
    participant Builder
    participant Factory

    User-&gt;&gt;Optics: setup(config)
    Optics-&gt;&gt;SessionMgr: create_session()
    SessionMgr-&gt;&gt;Session: new Session(config)
    Session-&gt;&gt;Builder: new OpticsBuilder()
    Session-&gt;&gt;Builder: add_driver(config)
    Builder-&gt;&gt;Factory: DeviceFactory.get_driver()
    Factory--&gt;&gt;Builder: driver instance
    Session-&gt;&gt;Builder: add_element_source(config)
    Builder-&gt;&gt;Factory: ElementSourceFactory.get_driver()
    Factory--&gt;&gt;Builder: element_source instance
    Builder--&gt;&gt;Session: configured builder
    Session--&gt;&gt;SessionMgr: session ready</code></pre> <h3 id=action-execution-flow>Action Execution Flow<a class=headerlink href=#action-execution-flow title="Permanent link">&para;</a></h3> <pre class=mermaid><code>sequenceDiagram
    participant User
    participant ActionKW
    participant StrategyMgr
    participant Strategy
    participant ElementSource
    participant Driver

    User-&gt;&gt;ActionKW: press_element(element)
    ActionKW-&gt;&gt;StrategyMgr: locate(element)
    StrategyMgr-&gt;&gt;Strategy: try strategies
    Strategy-&gt;&gt;ElementSource: locate/capture
    ElementSource--&gt;&gt;Strategy: coordinates
    Strategy--&gt;&gt;StrategyMgr: location
    StrategyMgr--&gt;&gt;ActionKW: coordinates
    ActionKW-&gt;&gt;Driver: press_coordinates(x, y)
    Driver--&gt;&gt;ActionKW: success</code></pre> <h2 id=extension-points>Extension Points<a class=headerlink href=#extension-points title="Permanent link">&para;</a></h2> <h3 id=adding-a-new-driver>Adding a New Driver<a class=headerlink href=#adding-a-new-driver title="Permanent link">&para;</a></h3> <ol> <li>Create class in <code>optics_framework/engines/drivers/</code></li> <li>Implement <code>DriverInterface</code></li> <li>Factory automatically discovers it</li> </ol> <h3 id=adding-a-new-element-source>Adding a New Element Source<a class=headerlink href=#adding-a-new-element-source title="Permanent link">&para;</a></h3> <ol> <li>Create class in <code>optics_framework/engines/elementsources/</code></li> <li>Implement <code>ElementSourceInterface</code></li> <li>Set <code>REQUIRED_DRIVER_TYPE</code> if driver-dependent</li> <li>Factory automatically matches with drivers</li> </ol> <h3 id=adding-a-new-vision-model>Adding a New Vision Model<a class=headerlink href=#adding-a-new-vision-model title="Permanent link">&para;</a></h3> <ol> <li>Create class in <code>optics_framework/engines/vision_models/</code></li> <li>Implement <code>ImageInterface</code> or <code>TextInterface</code></li> <li>Factory automatically discovers it</li> </ol> <h3 id=adding-a-new-keyword>Adding a New Keyword<a class=headerlink href=#adding-a-new-keyword title="Permanent link">&para;</a></h3> <ol> <li>Add method to appropriate API class</li> <li>Decorate with <code>@keyword("Keyword Name")</code></li> <li>Optionally add <code>@fallback_params</code> for fallback support</li> <li>Register in <code>KeywordRegistry</code></li> </ol> <h2 id=related-documentation>Related Documentation<a class=headerlink href=#related-documentation title="Permanent link">&para;</a></h2> <ul> <li><a href=../ >Architecture Overview</a> - High-level architecture</li> <li><a href=../engines/ >Engines</a> - Engine implementations</li> <li><a href=../strategies/ >Strategies</a> - Strategy pattern and self-healing</li> <li><a href=../execution/ >Execution</a> - Execution flow and data models</li> <li><a href=../error_handling/ >Error Handling</a> - Error handling system</li> <li><a href=../event_system/ >Event System</a> - EventSDK integration</li> <li><a href=../logging/ >Logging</a> - Logging architecture</li> <li><a href=../decisions/ >Architecture Decisions</a> - Design decisions and rationale</li> <li><a href=../../usage/REST_API_usage/ >REST API Usage</a> - REST API endpoints</li> <li><a href=../../api_reference/ >API Reference</a> - Python API documentation</li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/mozarkai/optics-framework target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "search.share", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>